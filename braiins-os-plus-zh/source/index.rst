.. toctree::
   :hidden:
   :maxdepth: 3
   :caption: Table of Contents:
   :glob:

   self
   Setup/index*
   Configuration/index*
   Basic User's Guide/index*
   Development/index*
   Braiins OS+ Manager/index*

---------------

.. raw:: html

    <script>
      window.fwSettings={
      'widget_id':77000003511
      };
      !function(){if("function"!=typeof window.FreshworksWidget){var n=function(){n.q.push(arguments)};n.q=[],window.FreshworksWidget=n}}()
    </script>
    <script type='text/javascript' src='https://euc-widget.freshworks.com/widgets/77000003511.js' async defer></script>

####
简介
####

Braiins OS+ 是专为ASIC矿机设计的增强性操作系统。它在已经相当可靠的 `Braiins OS <https://zh.braiins-os.com/community-edition>`_ 社区版的基础上，额外提供独有的矿机自动调整算法。当用户能提供最大允许的功耗（瓦数）时，系统将自动优化挖矿过程，让矿机算力最大化。这一过程具有输入普适性，让您能基于经济上的考虑，对矿机进行最大化效率或最高哈希率的优化。内部测试显示，在低功耗设置下，蚂蚁矿机S9运行我们固件能到达70J/THs或甚至更好的能耗比。在更高功耗设置下，能提升20%多的算力（与蚂蚁矿机S9原厂设置下的13.5 TH/秒 ~ 94J/TH相比）

固件目前支持蚂蚁矿机S9、S9i、S9j、S17、S17 Pro、S17+、T1、T17+、S17e和T17e。也即将发布对蚂蚁矿机S19、T19系列和对神马M20S的支持

********
固件特性
********
 
 * 具有能提高算力或效率的高级自动调整优化功能
 * 开源的操作系统
 * 完整应用改进数据效率和防止算力劫持的阶层Stratum V2协议
 * 内置由Rust语言从头编写的CGminer的代替品——BOSminer
 * 快速开机（5-7秒）
 * 未定义行为不会导致莫名其妙的死机
 * 批量安装
 * OPKG标准自动更新
 * 风扇自定义完全控制（可适用于液冷）
 * 高级监控功能，预防过热和其他问题
 * 自动更新机制
 * 动态功率调节模式，能在高温情况下自动降低功率，让挖矿不中断 
 * **对BTC Tools运维软件的支持**

  * BTC Tools批量运维软件现已新增对我们Braiins OS+固件20.11版本及以上的支持
  型号支持蚂蚁S9以及17系列矿机，请在这里下载用于Windows/Linux上的BTC Tools， `说明书也在下载页 <https://btccom.zendesk.com/hc/zh-cn/articles/360020105012>`_

  * Braiins OS+固件支持BTC Tools运维软件上除以下以外的所有功能：

    * “超频”/“降频”功能对Braiins OS+没用
    * “低功耗增强模式”（Enhanced LPM）会启动自动调整，并让矿机在默认功耗值的三分之二下运行
    * 禁用“低功耗增强模式”（Enhanced LPM）会让自动调整状态不变，并让矿机在默认功耗下运行（默认值大小取决于矿机型号）
    * 注：“低功耗模式”和“低功耗增强模式”只有在勾选“功耗控制”（Power Control)的情况下才能开启。不勾选则使用的是矿机上的设置
    * 使用BTC Tools不能开关固件内置的自动调整功能以及设置目标功耗值
    * 缺失部分属性描述
    * 如果在固件中配置了多个矿池组，在BTC Tools中只会显示最优先的那个矿池

*******************
客服和联系方式
*******************

您有任何问题？
欢迎随时联系我们的开发和技术团队。

加入我们的电报群：

  * `英语群 <https://t.me/BraiinsOS>`_
  * `俄语群 <https://t.me/BraiinsOS_RU>`_
  * `中文群 <https://t.me/BraiinsOS_ZH>`_ （也有微信群，可先加客服微信Braiins）

您也可以向我们的客服团队 `发送VIP请求 <https://help.slushpool.com/zh-CN/support/tickets/new>`_ 

*********
更新日志
*********

21.12.1
---------------------------

This is a minor bug-fix release for the x19, x17 and WhatsMiner family

* Antminer family

  * [bug] fixed performance problem on S19J and S19JPro due to wrong initialization sequence
  * [bug] adjust maximum frequency for S19JPro so that preheat doesn't exceed maximum allowed frequency on higher power limits
  * [bug] wait for voltage to settle in power controller on x17 models

21.12
---------------------------

本次发布是为蚂蚁矿机S19J Pro新增Beta版支持的重要更新

* 在所有类型的矿机上

  * 【特性】 在诊断包中新增了自动调整参数，方便更好地诊断
  * 【特性】 在矿机网页后台中新加入按钮，一键进入液冷模式
  * 【特性】 降低日志冗余程度，去掉了烦人的温度信息
  * 【特性】 日志不再含有让网页日志控制台混淆的颜色代码
  * 【特性】 日志加入对矿机关机原因的记录
  * 【BUG修复】 修复了在矿机网页后台数据图表中，单算力板的算力显示为矿机总算力的错误
  * 【BUG修复】 重新设计电压斜升调整的算法，现在更快了
  * 【BUG修复】 BOSminer在自动调整关闭状态下，用用户自定义的配置也能正常挖矿了
  * 【BUG修复】 从系统日志syslog中移除了日志分割logrotate信息

* 蚂蚁矿机S17和T17系列，S19和T19系列上

  * 【特性】 为蚂蚁矿机S19J Pro的Beta版支持
  * 【特性】 改进了对蚂蚁矿机S19J Pro的功耗值预测
  * 【特性】 用运算板温度，估算蚂蚁19系列矿机的算力芯片温度
  * 【特性】 移除了开启自动调整时风扇超控这一选项，风扇默认100%
  * 【BUG修复】 修复了在蚂蚁19系列上算力芯片无响应的问题

* 已知问题 ：

  * 在副厂控制板上有时会完全死机

21.09.3
---------------------------

本次发布是修复蚂蚁19系列的一些小问题的次要更新

* 在所有类型的蚂蚁矿机上

  * 【BUG修复】 修改bosminer.toml配置文件超控矿机不再会造成矿机网页前端锁定矿池设定
  * 【特性】 如果矿机型号自动识别出问题，矿机算力板EEPROM储存器上的内容将会被加载到系统日志中，以便排障

* 在蚂蚁矿机19系列上

  * 【BUG修复】 修复了部分S19机器自动识别错误识别成S19Pro的问题
  * 【特性】 进一步改进了对S19机型自动识别的能力

21.09.2
---------------------------

本次发布是修复蚂蚁17和19系列的一些小问题的次要更新

* 蚂蚁矿机S17和T17系列，S19和T19系列上 

  * 【BUG修复】 修复了S17Pro机型上的调整器启动问题
  * 【BUG修复】 修复了功率控制器锁死的问题

21.09.1
---------------------------

本次发布是提高用于浸没式冷却的S19系列和T19系列电源功耗限制的次要更新

* 蚂蚁矿机S19和T19系列

  * 【特性】 将APW12电源的功率限值提高到6500W。注意，高功率仅能用于能带动这么高功率的改装电源

21.09
---------------------------

本次发布对矿机网页后台界面进行了大改动，并对SD卡刷安装进行了优化

* 在所有类型的矿机上

  * 【特性】只插SD卡跑的矿机，现也支持像刷机（到NAND）之后一样的升级与自动升级功能
  * 【特性】为最大化地节能，在矿池URL都掉线的情况下，BOSminer挖矿软件会自动停止挖矿
  * 【特性】全新的矿机网页后台界面，提供夜间模式和翻译支持（之前仅在抢先体验版中有）

* 在蚂蚁矿机17系列上

  * 【特性】改进手动超控，以应对3个算力板都有有效EEPROM储存器，但其中的配置是其他型号矿机的情况。典型情况：买了用T17e的配置刷过EEPROM的二手S17

21.06.1
---------------------------

本次发布是改进蚂蚁矿机T17e的次要更新

* 蚂蚁矿机S17和T17系列

  * [BUG修复] 在T17e 使用适当的芯片初始化电压

21.06
---------------------------

本次发布是为蚂蚁矿机S17和T17系列（包含S17e和T17e）提供改进支持的重要更新

* 在蚂蚁矿机17系列上

  * 【特性】 改进的自动调整确保矿机在用户设定的功率等级到达优化的性能
  * 【特性】 对S17e 和T17e 的支持
  * 【特性】 对 T17、 T17+,、S17、 S17+改进的支持
  * 【特性】 Braiins OS+管家现在支持整个S17和T17系列
  * 【特性】 改进的动态功率调节。当矿机的温度低于过热温度至少5度，并风扇运行低于80%时，动态功率调节现在也会自动提高功率限制
  * 【特性】  只有在使用Braiins OS+管家的情况下，BOSminer才会运行并忽略不正确的配置，以便能修为配置。如果不适用Braiins OS+管家，BOSminer会在不正确的配置下自动关闭

21.04
---------------------------

本次发布新增对蚂蚁矿机S9的Braiins OS+管家的重要支持。Braiins OS+管家（Braiins OS+ Manager）是我们的矿机运维监控云平台

* 在所有类型的矿机上

  * 【特性】新增对Braiins OS+管家的支持。Braiins OS+管家是我们与FarmGod公司合作创建的矿机运维监控云平台
  * 【特性】在检测可用的阶层Stratum协议矿池服务器时，已对BOSminer的额外网络流量优化到最绝对最小
  * 【BUG修复】从SD卡启动时，现在会自动启用自动调整功能
  * 【BUG修复】即使配置不正确，BOSminer仍会运行，从而避免BOSminer停止时的连接丢失
  * 【BUG修复】修复了当矿池公共IP地址改变时出现的连接时间长的问题

21.02
---------------------------

* 在所有类型的矿机上

  * 【特性】 在矿机网页后台中新增了客服工具，用于生成并向我们发送报告
  * 【特性】 新设计了网页后台页面，矿机健康和性能数据一目了然
  * 【特性】 对工具箱中的发现（Discover）和单台矿机IP命令进行了优化
  * 【特性】 插卡开机现可直接刷入固件，不用再用电脑操作


* 在蚂蚁矿机X17系列上

  * 【特性】现可批量暂停/恢复各17系列矿机的挖矿，便于网格化管理的矿场运维。暂停命令示例如下： `echo '{"command":"pause"}' | nc IP_ADDRESS 4028`

20.12
---------------------------

* 在所有类型的矿机上

  * 【BUG修复】 修复了预先发布版版本不对的问题
  * 【BUG修复】 修复了网络设置中仅用了DHCP服务器的问题。由此之前带来的不便，敬请谅解

* 在蚂蚁矿机X17系列上

  * 【特性】 对未解锁官方固件锁的矿机，我们现提供从准备SD卡到上机自动卡刷的一条龙解决方案
  * 【特性】 现在对使用Macronix品牌NAND闪存的17系列机器完全支持
  * 【特性】 新增配置选项  [model_detection] （矿机型号检测），允许矿工超控运算板型号自动检测。从而能手动解决由于运算板上存储运算版信息的EEPROM内存损坏，造成的读不出板的情况。详见 use_config_fallback 部分的内容
  * 【特性】 新的FPGA允许最高超频到950 MHz（请注意：这么高的频率一般只能在液冷的情况下使用！）
  * 【特性】 更强大的电压设置，解决某些矿机在某段时间内超时无法设置电压的问题

20.11
---------------------------

本次发布改进了蚂蚁矿机X17系列固件的调整和综合性能

* 在所有类型的矿机上

  * 【特性】 BOS工具箱现有版本一个工具箱就能支持所有矿机型号。并且在批量操作（安装，配置，卸载等）时，可以自动识别矿机列表csv文件中的S9或X17系列矿机

* 在蚂蚁矿机X17系列上
  * 【特性】 全系在超频时最高频率限制为750 MHz
  * 【特性】 改进了全系的自动调整性
  * 【特性】 自动对故障运算板执行另外的解决方案
  * 【特性】 新增对T17和T17+的正式支持
  * 【BUG修复】 改进了S17+矿机算力性能
  * 【BUG修复】 已解决自动调整运作时API锁定的问题，矿机网页后台的图表在自动调整重启期间不再会无反应

* 在蚂蚁矿机S9上
  * 【特性】 - 一个BOS工具箱就能同时管理Braiins OS和Braiins OS+，一般默认为Braiins OS+。希望使用开源社区版的用户，请在安装时使用 --open-source 这个参数

20.10
---------------------------

本次发布是为蚂蚁矿机S17+新增Beta版支持的重要更新

* 在所有类型的矿机上

  * 【特性】 现在 procd 要等最多20秒，以便BOSminer正常关闭
  * 【特性】 BOSminer监控只会在当BOSminer停止运行时让风扇运转，给矿机降温
  * 【BUG修复】 解决了阶层Stratum客户端显示 'Stratum: unexpected accepted solution #0' 的问题
  * 【BUG修复】 解决了阶层Stratum客户端状态不正常的BUG（例如显示诸如像 "ERRO BUG: 'finish_shutdown_or_recover' 或 unexpected state 'Starting'" 这样的问题）
  * 【特性】 推荐计划现更好地支持同时支持推广多种不同的矿机类型
  * 【特性】 当BOS管理协议发生故障，从阶层Stratum V2协议连接切换到备用连接时，抽水也将同时被中继过去

* 在蚂蚁矿机S9上

  * 未对S9做特别改动

* 在蚂蚁矿机S17上

  * 【特性】 新增对S17+的支持support for S17+ has been added
  * 【特性】 由于S17系列的算力板上的焊接材料质量不好，对过热特别敏感，默认温度限值进一步降低到：目标温度：72 度，过热温度：85 度，危险温度：92 度
  * 【特性】 为让风扇正常运转，我们新增了对两种控制板（C49和C52）的自动区别。
  * 【特性】 在使用 'Macronix' 闪存的17系列矿机上，Braiins OS将拒绝安装。目前我们只支持使用 'Micron' 闪存的矿机
  * 【特性】 自动检测矿机型号（S17、S17 Pro和S17+），三机固件合一
  * 【特性】 基于检测到的矿机型号，对功率限值将进行动态计算调整

20.09.1
---------------------------

本次发布旨在修复部分Bug

* 在所有类型的矿机上

  * 【特性】 为恢复原域名解析行为，我们禁用了DNSmasq中的重绑定保护（Rebind Protection）功能。这就意味着矿场的DNS服务器可以对指向本地IP段的请求做出响应了。这将改善在本地运行阶层Stratum协议翻译代理服务器的矿场的用户体验
  * 【特性】 新增对可选挖矿的支持。支持某些矿池用阶层Stratum协议的消息类型 {ping/pong} 检查矿机活跃度 
  * 【BUG修复】 对另一个阶层Stratum V1老协议已知问题的迂回解决方案。有时V1协议不会在发生错误时，将结果标记为'null'（空），而是乱添油加醋（比如错误结果）。协议客户端在发生这种情况时将终止连接。我们对此在矿机后台记录中新增了一种警告记录信息（Warning log message），而协议客户端也会忽视这种异常，并能从异常中抽出全部的负载用于正常计算
  * 【BUG修复】 bosminer.toml 版本的格式现可被移植 

* 在蚂蚁矿机S17上

  * 【特性】 过热温度（Hot Temperature）限值降低到 100 度
  * 【排障特性】 矿机上最近发生的故障将会被发送到我们的记录服务器，以简化S17矿机排障的过程。如您不想开启此特性，您可以在 /etc/init.d/bosminer 中替换 "PROG=/usr/bin/bosminer-panic-wrapper" 为 "PROG=/usr/bin/bosminer" ，从而关闭它

20.09
---------------------------

本次发布包括对蚂蚁矿机S17和S17 Pro的支持，和对S9系列的维护性更新

* 在所有类型的矿机上

  * 【特性】推荐计划——您可以推广Braiins OS+获得回扣和佣金。联系我们获得您的专属固件安装包（带有您的推荐ID和配置文件），并邀请其他用户安装，您就能获得固件抽水的一部分作为您的回扣

* 已知问题

  * 【问题】固件后台显示的S17和S17 Pro矿机功耗低于实际功耗，下次更新会解决这个问题固件后台显示的S17和S17 Pro矿机功耗低于实际功耗，下次更新会解决这个问题
  * 【问题】当网络运营商ISP更改了用户的IP地址，BOSminer重连到矿池会很慢

20.06
---------------------------

本次更新的发布旨在通过应用新功能和修复关键问题，改进Braiins OS+和BOS工具箱的可用性

  * 在所有类型的矿机上

    * 【解决方法】新增对基于yyimp的矿池（例如prohashing）的支持，这种矿池在错误地发送以'0x'开头的，不符合比特币改进提案BIP-310规范的版本滚动掩码
    * 【特性】新增对阶层Stratum V1协议中的密码的支持，它们被一些矿池用于算法切换和其他用途
    * 【特性】自动升级机制的应用。矿机将定期检查，并在发现有升级可用后自动升级Braiins OS的新版本。在从原厂固件切换到Braiins OS时，这一功能将默认启用。但是在从Braiins OS或Braiins OS+的旧版本升级的情况下，必须手动启动这一功能
    * 【特性】通过日志轮转工具（Lograte）改进系统日志。系统日志将被自动压缩并保存在设备的NAND上，从而能保存更长时段的日志
    * 【特性】升级了BOS工具箱，现在它可以批量运行自定义命令了
    * 【BUG修复】使用SD卡方式安装映像刷矿机内置储存NAND时，现已能正确地从SD卡上迁移配置，而不是从内置储存NAND上的旧系统。
    * 【BUG修复】修复了在系统刷新缓冲区前关闭矿机时 *bosminer.toml* 文件为空的问题
    * 【BUG修复】IP Report按钮能正常使用了
    * 【特性】自动调整子系统现已可以保存性能配置文件到/etc/bosminer-autotune.json文件中。性能配置文件在每个功率等级，对每个编号的算力板都会进行记录
    * 【特性】动态功率调节现能在矿机达到用户设定的 *过热温度（Hot Tempreture）* 的情况下，自动降低矿机的功率限值。一旦达到最小功率限值，矿机将关机冷却。矿机将在用户设定的一段时间后，自动重启并恢复到原工作功率限值挖矿

  * 在蚂蚁矿机S9上

    * 【特性】我们切回使用赛灵思的I2C控制器核心进行与电压控制器的通信，并拓展了其用于噪声环境的故障过滤
    * 【特性】拓展了用于与计算芯片通信的串口输入引脚线（UART Rx）的故障过滤

20.04
---------------------------

本次发布的更新解决了大多数用户遇到的一些问题，例如安装/卸载的困难以及S9矿机上I2C控制器的一个主要问题。同时，我们也提供了固件的预先发行版了，现在使用 **BOS** 工具箱您就能启用它

  * 在所有类型的矿机上

    * 【特性】对重联的支持——我们在固件中应用了（`client.reconnect`）重联命令（在阶层Stratum V1协议中)，和阶层Stratum V2协议的重联消息
    * 【特性】改进了安装/卸载（ **upgrade2bos** 和 **restore2factory** 这两个进程）（从原厂固件过渡到Braiins OS等情况的进程同理）
    * 【特性】通过命令行命令（`--pool-user`）可以自定义矿池用户
    * 【特性】您原厂矿机固件中之前的矿池设置，现在会自动转移到BOSminer的配置中了。您也可以使用（`--no-keep-pools`）命令停用自动转移
    * 【特性】我们现在提供（基于pyinstaller的）二进制格式的 **upgrade2bos** 进程，它内置有最新的Braiins OS安装映像文件
    * 【特性】同样提供的也有（基于pyinstaller的）二进制格式的 **restore2factory** 进程，且现在不需要去下载或找到合适的原厂固件了
    * 【特性】默认停用了又占地方又花时间的原厂固件备份，可以通过（`--backup`）命令恢复启用。
    * 【特性】首次安装中保留主机名（Host name）的功能，可以通过（`--keep-hostname`）和（`--no-keep-hostname`）这两个命令控制，从而能超控根据MAC地址自动生成主机名。 
    * 【特性】在网页端后台的 **BOS** 工具箱中（以及旧版的 **矿机** 中），现已集成了对开启/关闭预先发布版的支持
    * 【特性】由于现在系统开启了 **日志轮替** 和对超过32KiB的'/var/log/syslog.old'旧系统记录文件进行自动压缩的功能， **BOSminer** 将能够提供的 **更长时间** 的 **系统日志** 。
    * 【BUG修复】SD卡固件中现已包含之前报错缺失的Slush Pool矿池验证公钥（阶层Stratum V2协议）
    * 【BUG修复】拒绝率现已显示正确值
    * 【BUG修复】从服务器收到的未知的阶层Stratum V1协议消息将保留日志作诊断用
    
  * 在蚂蚁矿机S9上
  
    * 【特性】自动调整状态现已在矿机网页端后台GUI中显示。已添加TUNERSTATUS这一API
    * 【BUG修复】在一些矿机上有时会出现I2C控制器总线锁死的情况，从而导致与I2C控制器共享总线的运算板供电控制器出现不响应的问题。出现问题的原因是我们将赛灵思的I2C控制器核心，整合进了现场可编程逻辑门阵列（FPGA）的位元流。我们已在SoC上切换到了I2C总线，位元流只将外围信号（IIC0）引导到相应的FPGA针脚上
    
20.03
---------------------------

  * 在所有类型的矿机上
      
    * 【特性】配置文件让用户能设定电源PSU的功率限制，自动调整算法会在设定的限制下，最大化矿机的能耗比每瓦算力

  * 在蚂蚁矿机S9上

    * 【特性】基于用户设定功率限制的自动调整功能

************
已知问题
************

以下列出了已发布版本中存在的已知问题

20.03 (更新于 3/30/2020)
-------------------------

  * 矿机网页图形界面（GUI)

   * 算力图表中的平均名义哈希率（Average Nominal Hashrate）参照线数值不准确。此问题只有运行的哈希链数量少于3个时才会发生
   * 拒绝率（Rejection ratio）被乘了100。例如，当拒绝率实际是0.1%时，显示的是10%

  * 配置
  
    * 用SD卡安装后，系统可能会在矿机/配置（Configuration）项中，报错缺少阶层Stratum V2协议的验证公钥， 
      (Error: missing upstream authority key for securing stratum2+tcp connection in pool")
      用户可以在配置项中，或直接在 ``/etc/bosminer.toml`` 文件内调整连接（包括密钥）
