################
راهنمای پیشرفته
################

.. contents::
	:local:
	:depth: 1

********
نقشه راه
********

ابزارها ، بسته ها و اسکریپت های زیادی وجود دارد که می تواند برای مدیریت Braiins OS+ استفاده شود. برای پیمایش بهتر ، از منوی زیر استفاده کنید:

 * نصب Braiins OS+ 
 
  * با استفاده از BOS Toolbox (:ref:`bosbox_install`)
  * با استفاده از بسته وب (:ref:`web_package_install`)
  * با استفاده از کارت حافظه SD (:ref:`sd_install`)
  * با استفاده از کارت حافظه SD و ابزار ماینر (:ref:`miner_nand_install`)
  * با استفاده از اسکریپت SSH (:ref:`ssh_package_install`)

 * باز کردن قفل SSH در دستگاه Antminer S9
 
  * با استفاده از BOS Toolbox (:ref:`bosbox_unlock`)  
  
 * بروز رسانی Braiins OS+
 
  * با استفاده از BOS Toolbox (:ref:`bosbox_update`)
  * با استفاده از OPKG (:ref:`opkg_update`)
  * با استفاده از بسته sysupgrade (:ref:`sysupgrade_switch_braiinsplus`)
  * با استفاده از اسکریپت bos2bos (:ref:`bos2bos`)
  
 * تغییر دادن به Braiins OS (نسخه بدون اتوتیونینگ)
 
  * با استفاده از بسته sysupgrade (:ref:`sysupgrade_switch_braiinsos`)
  * با استفاده از اسکریپت bos2bos (:ref:`bos2bos`)
  
 * تغییر دادن به Braiins OS+ (نسخه دارای اتوتیونینگ)
 
  * با استفاده از OPKG (:ref:`opkg_switch_to_braiinsplus`)
  * با استفاده از بسته sysupgrade (:ref:`sysupgrade_switch_braiinsplus`)
  * با استفاده از اسکریپت bos2bos (:ref:`bos2bos`)
  
 * بازنصب نسخه ابتدایی Braiins OS+ (نسخه ابتدایی, نسخه‌ای که برای اولین بار روی دستگاه نصب شده بود) - بازنشاندن حالت کارخانه
 
  * با استفاده از OPKG (:ref:`opkg_factory_reset`)
  * با استفاده از کارت حافظه SD (:ref:`sd_factory_reset`)
  * با استفاده از ابزار "miner" (:ref:`miner_factory_reset`)
  * با استفاده از اسکریپت bos2bos (:ref:`bos2bos`)
  
 * حذف نصب Braiins OS+

  * با استفاده از BOS Toolbox (:ref:`bosbox_uninstall`)
  * با استفاده از اسکریپت SSH (:ref:`ssh_package_uninstall`)

 * فعال/غیرفعال فید نسخه‌های شبانه

  * با استفاده از ابزار "miner" (:ref:`miner_nightly`)

 * فعال/غیرفعال کردن بروز رسانی خودکار

  * با استفاده از ابزار "miner" (:ref:`miner_autoupgrade`)

 * اجرای دستورات سفارشی بر روی ماینر

  * با استفاده از BOS Toolbox (:ref:`bosbox_command`)

.. _bosbox:

******************
ابزار BOS Toolbox
******************

BOS Toolbox ابزاری جدید است که به کاربر اجازه می دهد تا به راحتی Braiins OS+ را نصب ، حذف ، بروزرسانی  و تنظیم کند. همچنین امکان انجام این کار در حالت دسته ای نیز فراهم شده است و این امر باعث می شود مدیریت تعداد بیشتر دستگاه ها آسان تر شود. همچنین BOS Toolbox آخرین نسخه فریم‌ور را به صورت خودکار دانلود خواهد کرد. این روش پیشنهادی برای مدیریت دستگاه های شما است.

==========
روش کاربرد
==========

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد. **.فقط از یک آدرس IP در هر سطر استفاده کنید!**
  * بخش های زیر را دنبال کنید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + Braiins OS+ را از راه دور نصب می‌کند و به صورت خودکار قفل SSH را بر روی Antminer S9 هنگام نصب باز میکند
  + Braiins OS+ را از راه دور بروزرسانی می کند
  + Braiins OS+ را از راه دور پاک می کند
  + Braiins OS+ را از راه دور تنظیم می کند
  + اجرای دستورات سفارشی بر روی دستگاه‌ها
  + شبکه دستگاه ها را اسکن می کند
  + هنگام نصب Braiins OS+، کل تنظیمات را بطور پیش فرض (می توان تنظیم کرد) منتقل می کند
  + هنگام حذف Braiins OS+، تنظیمات شبکه را بطور پیش فرض (می توان تنظیم کرد) منتقل می کند
  + پارامترها برای سفارشی کردن فرآیند در دسترس هستند
  + روشن شدن اتوتیونینگ با پاور حد پیشفرض (1420وات) زمانی که Braiins OS+ را نصب میکنید
  + حالت دسته ای برای مدیریت چندین دستگاه به طور همزمان
  + استفاده آسان

  - بر روی دستگاه‌های X17 که SSH قفل شده دارند کارایی ندارد

.. _bosbox_install:

==================================================
Braiins OS+ را با استفاده از BOS Toolbox نصب کنید
==================================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید. **تنها یک آدرس آی پی در هر سطر بنویسید**
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:

::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.bat install ARGUMENTS HOSTS

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox install ARGUMENTS HOSTS

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم فرآیند می توانید از **ARGUMENTS** زیر استفاده کنید:

**نکته مهم:** 
هنگاه نصب Braiins OS+ در **یک دستگاه** به جای آرگومان *HOSTS* آی پی دستگاه مورد نظر را درج نمایید.
هنگام نصب Braiins OS+ روی **چندین دستگاه** ، به جای *HOSTS* مسیر فایلی که لیست آی پی دستگاه‌ها در آن درج شده استفاده نمایید. 

====================================  ============================================================
آرگومان‌ها                             توضیحات
====================================  ============================================================
-h, --help                            پیغام help نشان داده شود و سپس خارج می‌شود
--open-source                         برای نصب نسخه متن باز مورد استفاده قرار می‌گیرد (اختصاصی با **nightly** و **feed-url**)
--nightly                             برای نصب نسخه شبانه مورد استفاده قرار می‌گیرد (اختصاصی با **open-source** و **feed-url**)
--feeds-url [FEEDS_URL]               بازنویسی آدرس‌های فید سرورهای پیشفرض (اختصاصی با **open-source** و **nightly**)
--fw-version                          انتخاب نسخه خاص فریم‌ور
--backup                              قبل از ارتقا از ماینر بک آپ می‌گیرد
--no-auto-upgrade                     خاموش کردن امکان بروز رسانی خودکار فریم‌ور نصب شده
--no-nand-backup                      بک آپ کامل حافظه NAND را رد می‌کند( تنظیمات بک‌ آپ گرفته میشوند)
--pool-user [POOL_USER]               نام کاربری و نام worker برای استخر پیش فرض تنظیم می‌کند
--psu-power-limit		                  تنظم حد پاور (در واحد وات, Braiins OS+ فقط)
--no-keep-network                     تنظیمات شبکه ماینر را ذخیره نمی‌کند(از DHCP استفاده کنید)
--no-keep-pools                       تنظیمات استخر ماینر را ذخیره نمی‌کند
--no-keep-hostname                    نام میزبان ماینر را ذخیره نمی‌کند و نام جدید بر اساس MAC  بسازید
--keep-hostname                       اجبار به نگهداشتن نام میزبان
--no-wait                             نیازی نیست تا زمانی که سیستم به طور کامل ارتقا یافته صبر می‌کند.
--dry-run                             تمام مراحل ارتقا را بدون انجام واقعی ارتقا انجام می‌دهد
--post-upgrade [POST_UPGRADE]         مسیر به دایرکتوری با اسکریپت stage3.sh
--bos-mgmt-id [BOS_MGMT_ID]	          تنظیم شناسه BOS management
-p PASSWORD, --password PASSWORD      کلمه عبور مدیریت
====================================  ============================================================

**مثال:**

::

  bos-toolbox.bat install --psu-power-limit 1200 --password root listOfMiners.csv

این دستور Braiins OS+ را روی ماینرهایی نصب می کند که در فایل *listOfMiners.csv* مشخص شده اند. این فرمان همچنین به طور خودکار دستگاههای Antminer S9 را آنلاک می کند.

.. _bosbox_update:

=================================================
بروز رسانی Braiins OS+ با استفاده از BOS Toolbox
=================================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/plus/download/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید.
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.bat update ARGUMENTS HOST PACKAGE

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox update ARGUMENTS HOST PACKAGE

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم فرآیند می توانید از **ARGUMENTS** زیر استفاده کنید:

**نکته مهم:** 
هنگاه نصب Braiins OS+ در **یک دستگاه** به جای آرگومان *HOSTS* آی پی دستگاه مورد نظر را درج نمایید.
هنگام نصب Braiins OS+ روی **چندین دستگاه** ، به جای *HOSTS* مسیر فایلی که لیست آی پی دستگاه‌ها در آن درج شده استفاده نمایید. 
*PACKAGE* اختیاری است، زمانی استفاده کنید که به نسخه ای غیر از *firmware* بروز رسانی میکنید. 

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
--h, --help                            پیغام help نشان داده شود و سپس خارج می‌شود
-p PASSWORD, --password PASSWORD      رمزعبور مدیریتی
-i, --ignore                          چشم‌پوشی هنگام خطا
PACKAGE				                        نام package بروز رسانی
====================================  ============================================================


**مثال:**

::

  bos-toolbox.bat update listOfMiners.csv

این دستور برای ماینرهایی که در *listOfMiners.csv* مشخص شده اند ،  بروزرسانی را جستجو‌میکند و در صورت وجود نسخه جدیدی از فریم‌ور، آنها را به روز می کند.

.. _bosbox_uninstall:

==============================================
حذف نصب Braiins OS+ با استفاده از BOS Toolbox
==============================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/plus/download/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید.
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:
  * یک فایل جدید text در ویرایشگر متنی خود ایجاد کنید و آدرس‌های IP که میخواهید دستورات در آنها اجرا شود را وارد کنید.**تنها یک آدرس آی پی در هر سطر بنویسید** (توجه کنید که میتوانید آی پی آدرس دستگاه را با مراجعه به منوی *Status - > Overview* در رابط کاربری وب پیدا کنید.) سپس فایل را در همان پوشه ای که BOS Toolbox هست ذخیره کنید و پسوند فایل را از ".txt" به ".csv" تغییر نام دهید.
  * عبارت *FILE_PATH_TO_BOS_TOOLBOX* را در دستور زیر با مسیری که فایل BOS Toolbox را ذخیره کرده‌اید تغییر دهید. سپس با دستور زیر به فایل بروید: ::

::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.bat uninstall ARGUMENTS HOSTS BACKUP_PATH

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox uninstall ARGUMENTS HOSTS BACKUP_PATH

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم فرآیند می توانید از **ARGUMENTS** زیر استفاده کنید:

**نکته مهم:** 
هنگاه نصب Braiins OS+ در **یک دستگاه** به جای آرگومان *HOSTS* آی پی دستگاه مورد نظر را درج نمایید.
هنگام نصب Braiins OS+ روی **چندین دستگاه** ، به جای *HOSTS* مسیر فایلی که لیست آی پی دستگاه‌ها در آن درج شده استفاده نمایید. 
*BACKUP_PATH* اختیاری است، فقط در ترکیب با آرگومان *--nand-restore* استفاده نمایید.

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
-h, --help                            پیغام help نشان داده شود و سپس خارج می‌شود
--install-password INSTALL_PASSWORD   کلمه عبور ssh برای عملیات نصب
--feeds-url [FEEDS_URL]		             بازنویسی آدرس فید سرورهای پیشفرض
--nand-restore			                  استفاده از بازگردانی کامل NAND از نسخه پشتیبان پیشین
--BACKUP_PATH                         مسیر به فولدر یا فایل tgz با داده‌های مرتبط با ماینر
====================================  ============================================================

**مثال:**

::

  bos-toolbox.bat uninstall listOfMiners.csv

این دستور Braiins OS+ را از ماینرهایی که در فایل *listOfMiners.csv* لیست شده اند حذف می‌کند و فریم‌ور اصلی پیشفرض را نصب می‌کند.

**هشدار:** فریمور نسخه کارخانه ای که هنگام حذف +Braiins OS بر روی دستگاه نصب می‌گردد مناسب برای عملیات ماینینگ نیست! لطفا قبلا از شروع ماینینگ، نسخه مخصوص فریم‌ور کارخانه دستگاه خود را به آخرین نسخه بروز رسانی نمایید.

.. _bosbox_configure:

===========================================
تنظیم Braiins OS+ با استفاده از BOS Toolbox
===========================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/plus/download/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید. **تنها یک آدرس آی پی در هر سطر بنویسید**
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:
  * یک فایل جدید text در ویرایشگر متنی خود ایجاد کنید و آدرس‌های IP که میخواهید دستورات در آنها اجرا شود را وارد کنید. **تنها یک آدرس آی پی در هر سطر بنویسید** (توجه کنید که میتوانید آی پی آدرس دستگاه را با مراجعه به منوی *Status - > Overview* در رابط کاربری وب پیدا کنید.) سپس فایل را در همان پوشه ای که BOS Toolbox هست ذخیره کنید و پسوند فایل را از ".txt" به ".csv" تغییر نام دهید.
  * عبارت *FILE_PATH_TO_BOS_TOOLBOX* را در دستور زیر با مسیری که فایل BOS Toolbox را ذخیره کرده‌اید تغییر دهید. سپس با دستور زیر به فایل بروید: ::

::

        cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.bat config ARGUMENTS ACTION TABLE

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox config ARGUMENTS ACTION TABLE

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم فرآیند می توانید از **ARGUMENTS** زیر استفاده کنید:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
-h, --help                             پیغام help نشان داده شود و سپس خارج می‌شود
-u USER, --user USER                  نام کاربری مدیریتی
-p PASSWORD, --password PASSWORD      کلمه عبور مدیریتی یا اینکه پرسیده میشود
--change-password                     اجازه تغییر کلمه عبور را می‌دهد (به آنهایی که در *listOfMiners.csv* لیست شده اند)
-c, --check                           Dry run sans writes
-i, --ignore                          در مواجه با خطا چشم‌پوشی کند
====================================  ============================================================

شما باید **تنها یکی از** **عملیات** زیر را بکار گیرید:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
load                                  بارگیری تنظیمات حال حاضر ماینر (دستگاهی که در فایل csv 
                                      مشخص شده) و وارد کردن آن به فایل csv
save                                  ذخیره تنظیمات از فایل csv در ماینرها
                                      (آنها را اعمال نمیکند)
apply                                 اعمال تنظیماتی که از فایل csv روی ماینرها ذخیره 
                                      کرده بود
save_apply                            ذخیره و اعمال تنظیمات از فایل csv روی ماینرها
====================================  ============================================================

**مثال:**

::

  bos-toolbox.bat config --user root load listOfMiners.csv
  
   #فایل CSV را ویرایش کنید (برای مثال با نرم افزارهای Office Excel, LibreOffice Calc و غیره)
  
  bos-toolbox.bat config --user root -p admin --change-password save_apply listOfMiners.csv


اولین دستور تنظیمات را از ماینرهایی که در فایل *listOfMiners.csv* لیست شده است بارگیری خواهد کرد. (با استفاده از نام کاربری *root* و در فایل CSV ذخیره خواهد کرد.) شما اکنون میتوانید فایل را باز و ویرایش‌های دلخواه خود را انجام دهید. بعد از ویرایش، دستور دوم تنظیمات را به ماینرها بازخواهد گرداند، در آنها اعمال خواهد کرد و به پسوردی که در ستون پسورد است تغییر خواهد داد. 

.. _bosbox_scan:

==========================================================
اسکن شبکه برای شناسایی ماینرها با استفاده از BOS Toolbox
==========================================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/plus/download/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید.
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:
  * یک فایل جدید text در ویرایشگر متنی خود ایجاد کنید و آدرس‌های IP که میخواهید دستورات در آنها اجرا شود را وارد کنید.**تنها یک آدرس آی پی در هر سطر بنویسید** (توجه کنید که میتوانید آی پی آدرس دستگاه را با مراجعه به منوی *Status - > Overview* در رابط کاربری وب پیدا کنید.) سپس فایل را در همان پوشه ای که BOS Toolbox هست ذخیره کنید و پسوند فایل را از ".txt" به ".csv" تغییر نام دهید.
  * عبارت *FILE_PATH_TO_BOS_TOOLBOX* را در دستور زیر با مسیری که فایل BOS Toolbox را ذخیره کرده‌اید تغییر دهید. سپس با دستور زیر به فایل بروید: ::

::

    cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.bat discover ARGUMENTS

    برای خط فرمان **Linux**: ::
      
     ./bos-toolbox discover ARGUMENTS

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم روند می توانید از **آرگومان‌های** زیر استفاده کنید:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
-h, --help                             پیغام help نشان داده شود و سپس خارج می‌شود
====================================  ============================================================

شما باید **تنها یکی از** **arguments** زیر را بکار گیرید:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
scan                                  به صورت فعال محدوده آدرسهای مشخص شده را اسکن میکند
listen                                گوش فرا دادن به پخش‌های ارسال دستگاه
                                      (مانند زمانی که دکمه IP Reporter را فشار میدهید)
====================================  ============================================================

**مثال:**

::

 #اسکن شبکه در محدوده رنج آی پی 10.10.10.0 - 10.10.10.255
  bos-toolbox.bat discover scan 10.10.10.0/24

  #اسکن شبکه در محدوده رنج آی پی 10.10.0.0 - 10.10.255.255
  bos-toolbox.bat discover scan 10.10.0.0/16

  #اسکن شبکه در محدوده رنج آی پی 10.0.0.0 - 10.255.255.255
  bos-toolbox.bat discover scan 10.0.0.0/8

.. _bosbox_command:

================================================
اجرای دستورات سفارشی در ماینرها با BOS Toolbox
================================================

 * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/plus/download/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید. 
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:
  * یک فایل جدید text در ویرایشگر متنی خود ایجاد کنید و آدرس‌های IP که میخواهید دستورات در آنها اجرا شود را وارد کنید.**تنها یک آدرس آی پی در هر سطر بنویسید** (توجه کنید که میتوانید آی پی آدرس دستگاه را با مراجعه به منوی *Status - > Overview* در رابط کاربری وب پیدا کنید.) سپس فایل را در همان پوشه ای که BOS Toolbox هست ذخیره کنید و پسوند فایل را از ".txt" به ".csv" تغییر نام دهید.
  * عبارت *FILE_PATH_TO_BOS_TOOLBOX* را در دستور زیر با مسیری که فایل BOS Toolbox را ذخیره کرده‌اید تغییر دهید. سپس با دستور زیر به فایل بروید: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:


    برای خط فرمان **Windows**: ::

      bos-toolbox.bat command ARGUMENTS TABLE COMMAND

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox command ARGUMENTS TABLE COMMAND
      
    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم روند می توانید از **آرگومان‌های** زیر استفاده کنید:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
-h, --help                            پیغام help نشان داده شود و سپس خارج می‌شود
-a, --auto                            استفاده از ssh زمانی که rpc در دسترس نباشد
-l, --legacy                          استفاده ssh
-L, --no-legacy                       استفاده از rpc
-o, --output                          خروجی از راه دور را ضبط و چاپ کنید
-O, --output-hostname                 خروجی از راه دور را ضبط و چاپ کنید
-p PASSWORD, --password PASSWORD      مدیریت کلمه عبور
-j JOBS, --jobs JOBS                  تعداد عملیات همزمان
====================================  ============================================================

You **have to use one** of the following **command** to adjust the process:
شما **باید یکی** از **دستورات** زیر را برای تنظیم روند استفاده کنید:

====================================  ============================================================
Commands                              Description
====================================  ============================================================
start                                 شروع BOSminer 
stop                                  متوقف کردن BOSminer
*custom_shell_command*                جایگزینی *custom_shell_command* با دستور shell سفارشی خود 
                                      (e.g. *cat /etc/bosminer.toml* to show the content 
                                      of the *bosminer.toml* configuration file)
====================================  ============================================================

**Example:**

::

  #stop BOSminer, effectively stopping mining and decreasing the power draw to minimum
  bos-toolbox.bat command -o list.csv stop

.. _bosbox_unlock:

===================================================================
باز کردن قفل SSH در دستگاه Antminer S9 با استفاده از BOS Toolbox
===================================================================

  * **BOS Toolbox** را از وبسایت ما `دانلود کنید <https://braiins-os.com/plus/download/>`_.
  * یک فایل متنی جدید ایجاد کنید، پسوند فایل را از ".txt" به ".csv" تغییر دهید و آی پی دستگاه هایی که میخواهید دستور در آنها اجرا شود را وارد نمایید. فایل را به پوشه‌ای که BOS Toolbox قرار دارد انتقال دهید. **هر آی پی را در یک سطر بنویسید!**
  *‌ زمانی که BOS Toolbox را دانلود کردید،‌ خط فرمان خود را اجرا کنید. (برای مثال: CMD برای Windows, Terminal برای Ubuntu)
  * در دستورات زیر *FILE_PATH_TO_BOS_TOOLBOX* را با مسیر پوشه ای که BOS Toolbox را ذخیره کرده‌اید تغییر دهید. سپس مسیر را از طریق اجرای دستور زیر تغییر دهید:
  ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * حالا فایل *listOfMiners.csv* را با نام فایلی که شما برای لیست آی پی های دستگاه‌ها ایجاد کرد‌ه‌اید در دستور زیر تغییر دهید و متناسب با سیستم عامل خود دستور را اجرا کنید:

    برای **Windows** دستور خط فرمان: ::

      bos-toolbox.bat unlock ARGUMENTS HOSTS

    برای **Linux** دستور خط فرمان: ::
      
      ./bos-toolbox unlock ARGUMENTS HOSTS

    **توجه:** *زمان استفاده از BOS Toolbox در لینوکس، شما باید فایل را طبق دستور زیر به حالت اجرایی تبدیل کنید (این برای یکبار است):* ::
  
      chmod u+x ./bos-toolbox

شما میتوانید از آرگومان‌های **arguments** زیر استفاده کنید:

**نکته مهم:** 
هنگاه نصب Braiins OS+ در **یک دستگاه** به جای آرگومان *HOSTS* آی پی دستگاه مورد نظر را درج نمایید.
هنگام نصب Braiins OS+ روی **چندین دستگاه** ، به جای *HOSTS* مسیر فایلی که لیست آی پی دستگاه‌ها در آن درج شده استفاده نمایید. 

====================================  ============================================================
Arguments  آرگومان‌ها                  Description توضیحات
====================================  ============================================================
--h, --help                           نمایش راهنما
-u USERNAME, --username USERNAME      نام کاربری رابط وب
-p PASSWORD, --password PASSWORD      رمز عبور رابط وب
--port PORT                           شماره پورت برای رابط وب Antminer
--ssl                                 آیا SSL استفاده بشود یا خیر
====================================  ============================================================


**مثال:**

::

  bos-toolbox.bat unlock listOfMiners.csv -p admin

این دستور قفل SSH ماینرهایی که در فایل *listOfMiners.csv* لیست شده اند را باز خواهد کرد.

.. _web_package:

*******************
بسته Web Package
*******************

بسته مبتنی بر وب می تواند برای جابجایی از فریم ویر اصلی کارخانه ، که قبل از سال 2019 منتشر شد ، مورد استفاده قرار گیرد. همچنین باید روی سایر فریم ویر های اصلی کارخانه کار کند. این بسته نمی تواند برای فیرم ویرهایی استفاده شود که در سال 2019 و بعداً به دلیل تأیید امضای تعبیه شده در دستگاه انتشار یافت. تأیید امضا، از استفاده فریم ویر های غیر از فریم ویر اصلی جلوگیری می کند.

===========
روش کاربرد
===========

  * بسته **Web Package** را از `وبسایت <https://braiins-os.com/>`_ دانلود کنید.
  * بخش های زیر را دنبال کنید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + فریم‌ور اصلی کارخانه را با Braiins OS+ بدون ابزار اضافی جایگزین می کند
  + تنظیمات شبکه را انتقال می دهد
  + نشانی اینترنتی استخر ، کاربران و رمزهای عبور را انتقال میدهد
  + اتوتونینگ را روی حد پاور (1420وات) روشن میکند

  
  - نمی توان در فریم ویر های کارخانه که در سال ۲۰۱۹ و بعد از آن منتشر شده، استفاده کرد
  - نمی تواند نصب را تنظیم کند (به عنوان مثال ، همیشه تنظیمات شبکه را منتقل می کند)
  - بدون batch-mode(مگر اینکه اسکریپت های خود را بسازید)


.. _web_package_install:

=====================================
نصب Braiins OS+ با استفاده از بسته Web
=====================================

  * بسته **Web Package** را از وب سایت `website <https://braiins-os.com/>`_. دانلود کنید.
  * وارد ماینر خود شوید و به بخش *System -> Upgrade* بروید.
  * بسته دانلود شده را آپلود کرده و فایل ایمیج را فلش کنید.

.. _sd:

*******************
ایمیج کارت حافظه SD
*******************

اگر فریم ویر کارخانه را اجرا می کنید ، که در سال 2019 و بعد از آن منتشر شد ، تنها راه نصب Braiins OS+ وارد کردن کارت SD با Braiins OS+ است که روی آن فلش شده است. در سال 2019 ، اتصال SSH مسدود شد و تأیید امضا در رابط کاربری وب مانع استفاده غیر از فریمور اصلی کارخانه می شود.

==========
روش کاربرد
==========

  **SD card image** را از `وبسایت <https://braiins-os.com/>`_ دانلود کنید.
  * بخش های زیر را دنبال کنید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  +  فریم‌ور کارخانه را که SSH آن مسدود شده است با Braiins OS+ جایگزین می کند
  + از تنظیمات شبکه ذخیره شده در NAND استفاده می کند (این گزینه می تواند خاموش شود ، به بخش *Network settings* از زیر مراجعه کنید)
  + اتوتونینگ را روی حد پاور (1420وات) روشن میکند

  - آدرس URL استخرها، کاربران و رمز عبور ها را منتقل نمیکند
  - بدون batch-mode

.. _sd_install:

=============================================
نصب Braiins OS+ با استفاده از کارت حافظه SD
=============================================

 * ایمیج کارت حافظه SD را از `وبسایت <https://braiins-os.com/>`_ دانلود کنید.
 * فایل دانلود شده را روی کارت حافظه SD فلش کنید. (بطور مثال: با نرم افزار `Etcher <https://etcher.io/>`_) *توجه: کپی ساده فایل روی کارت SD کار نخواهد کرد. کارت SD باید فلش شود!*
 * **(فقط Antminer S9)** جامپرها را برای بوت شدن از کارت حافظه SD (بجای حافظه NAND) به صورت زیر تغییر دهید.

  .. |pic1| image:: ../_static/s9-jumpers.png
      :width: 45%
      :alt: S9 Jumpers

  .. |pic2| image:: ../_static/s9-jumpers-board.png
      :width: 45%
      :alt: S9 Jumpers Board

  |pic1|  |pic2|

 * کارت SD را در شیار دستگاه قرار دهید و دستگاه را روشن کنید.
 * بعد از چند لحظه شما باید به رابط کاربری Braiins OS+ از طریق آدرس IP دستگاه دسترسی داشته باشید.
 * *[اختیاری]:* شما می‌توانید Braiins OS+ را روی NAND نصب کنید. (بخش مربوطه را ببینید :ref:`sd_nand_install`)

.. _sd_network:

================
تنظیمات شبکه
================
 
 به صورت پیشفرض، تنظیمات شبکه‌ای که روی NAND ذخیره شده در حالت اجرای Braiins OS+ از کارت SD مورد استفاده قرار میگیرد.
 برای غیرفعالسازی این امکان، مراحل زیر را طی کنید:

  * اولین پارتیشن FAT کارت حافظه SD را Mount کنید
  * فایل uEnv.txt را باز کنید و متن زیر را در فایل بنویسید. (دقت کنید در هر سطر یک دستور باشد)

  ::

    cfg_override=no

غیرفعالسازی استفاده از تنظیمات شبکه قدیمی برای کاربرانی سودمند است که مشکلاتی در زمینه مشاهده ماینر در شبکه دارند. (بطور مثال: آی پی که روی NAND استفاده شده بود خارج از رنج شبکه فعلی است). به این ترتیب DHCP استفاده خواهد شد.

.. _sd_nand_install:

============
NAND نصب در
============

از کارت حافظه SD می توان برای جایگزینی فریم‌ور در NAND با Braiins OS+ استفاده کرد. این کار می تواند از این روش انجام شود:
  * برای نصب خودکار روی حافظه NAND میتوانید عبارت ``nand_install=yes`` را در فایل ``uEnv.txt`` اضافه کنید.
  * با استفاده از رابط کاربری وب - بخش *System -> Install current system to device (NAND)*
  * با استفاده از ابزار *miner* ، از طریق SSH - این بخش از راهنما را دنبال کنید :ref:`miner_nand_install`

.. _sd_factory_reset:

===================================================================
بازگشت به تنظیم کارخانه Braiins OS+ با استفاده از کارت حافظه SD
===================================================================

با دنبال کردن مراحل زیر می توانید تنظیم مجدد و بازگشت به تنظیم کارخانه را انجام دهید:

  * Mount the first FAT partition of the SD card
  * Open the file uEnv.txt and insert the following string (make sure there is only one string per line)

  ::

    factory_reset=yes

.. _ssh_package:

****************************
نصب از راه دور با (SSH)
****************************

با روش *Remote (SSH) install package* شما میتوانید Braiins OS+ را نصب یا حذف کنید. این روش توصیه نمی‌شود زیرا نیاز به نصب بسته‌های پایتون دارد. به جای آن از BOS Toolbox استفاده کنید.


==========
روش کاربرد
==========

  * دانلود بسته **Remote (SSH) install package** از `وبسایت <https://braiins-os.com/>`_.
  * بخش های زیر را دنبال کنید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + Braiins OS+ را از راه دور نصب می کند
  + Braiins OS+ را از راه دور پاک می کند
  + هنگام نصب Braiins OS+ ، کل تنظیمات را بطور پیش فرض (می توان تنظیم کرد) منتقل می کند
  + هنگام حذف Braiins OS+، تنظیمات شبکه را بطور پیش فرض (می توان تنظیم کرد) منتقل می کند
  + پارامترها برای سفارشی کردن فرآیند در دسترس هستند
  + اتوتونینگ را روی حد پاور (1420وات) روشن میکند

  
 - بدون batch-mode(مگر اینکه اسکریپت های خود را بسازید)
  - نیاز به راه اندازی طولانی دارد
  - درماینری که SSH آن مسدود شده است کار نمی کند

.. _ssh_package_environment:

=========================
آماده سازی محیط
=========================

ابتدا باید محیط پایتون را آماده کنید که شامل مراحل زیر است:

* * (فقط ویندوز) *Ubuntu for Windows 10* از فروشگاه مایکروسافت `در اینجا. <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6> `_ نصب کنید

* دستورات زیر را در ترمینال خط فرمان خود اجرا کنید:

*(توجه داشته باشید که دستورات برای ویندوز 10 با اوبونتو و اوبونتو سازگار است. اگر از توزیع دیگری از لینوکس یا سیستم عامل متفاوتی استفاده می کنید ، لطفا مستندات مربوطه را بررسی کرده و در صورت لزوم دستورات را ویرایش کنید.)*

::

  #مخازن را بروز رسانی کرده و پیش نیازها را نصب کنید  
  sudo apt update && sudo apt install python3 python3-virtualenv virtualenv
  
  #بسته فریم‌ور را دانلود و از حالت فشرده خارج کنید
  #Antminer S9
  wget -c https://feeds.braiins-os.com/20.10/braiins-os_am1-s9_ssh_2020-10-25-0-908ca41d-20.10-plus.tar.gz -O - | tar -xz
  
  #Antminer S17
  wget -c https://feeds.braiins-os.com/20.11/braiins-os_am2-s17_ssh_2020-11-27-0-5eb922d4-20.11-plus.tar.gz -O - | tar -xz

  #مسیر دایرکتوری را به مسیر بسته غیرفشرده شده تغییر دهید
  #Antminer S9
  cd ./braiins-os_am1-s9_ssh_VERSION
  
  #Antminer S17
  cd ./braiins-os_am2-s17_ssh_VERSION

  #یک virtual environment ایجاد و آن را فعال سازی کنید
  virtualenv --python=/usr/bin/python3 .env && source .env/bin/activate
  
  #بسته های مورد نیاز پایتون را نصب کنید
  python3 -m pip install -r requirements.txt

.. _ssh_package_install:

=====================================
نصب Braiins OS+ با استفاده از بسته SSH
=====================================

نصب Braiins OS+ با استفاده از روش به اصطلاح *SSH Method* شامل مراحل زیر است:

* *(Custom Firmware)* فریم‌ویر اصلی کارخانه را فلش کنید. اگر دستگاه با فریم ویر اصلی کارخانه  یا نسخه های قبلی Braiins OS+ کار کند ، می توانید از این مرحله صرفنظر کنید. * (توجه: ممکن است که Braiins OS+ مستقیماً بر روی یک سیستم عامل سفارشی نصب شود ، اما از آنجا که با نسخه اصلی کارخانه تفاوت دارند ، ممکن است لازم باشد ابتدا فریم‌ ویر اصلی را فلش کنید.)*

* * (فقط ویندوز) *Ubuntu for Windows 10* را از فروشگاه مایکروسافت `در اینجا نصب کنید <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6> `_
* محیط پایتون را آماده کنید ، که در این بخش توضیح داده شده است :ref:`ssh_package_environment`.
* دستورات زیر را در ترمینال خط فرمان خود اجرا کنید (بر این اساس  ``IP_ADDRESS`` را جایگزین کنید):


*(توجه داشته باشید که دستورات برای ویندوز 10 با اوبونتو و اوبونتو سازگار است. اگر از توزیع دیگری از لینوکس یا سیستم عامل متفاوتی استفاده می کنید ، لطفا مستندات مربوطه را بررسی کرده و در صورت لزوم دستورات را ویرایش کنید.)*

::

  #مسیر دایرکتوری را به مسیر بسته غیرفشرده شده تغییر دهید (اگر در حال حاضر در آن نیست)
  #Antminer S9
  cd ./braiins-os_am1-s9_ssh_VERSION
  
  #Antminer S17
  cd ./braiins-os_am2-s17_ssh_VERSION

  #فعال سازی virtual environment (درصورتیکه فعال نیست)
  source .env/bin/activate
  
  #اسکریپت را اجرا کنید تا Braiins OS+ نصب شود
  python3 upgrade2bos.py IP_ADDRESS

.. _ssh_package_uninstall:

=======================================
حذف نصب Braiins OS+ از طریق بستهSSH
=======================================

.. _ssh_package_uninstall_image:

استفاده از فریم‌ور کارخانه
=============================

ابتدا ، شما باید محیط پایتون را آماده کنید ، که در این بخش توضیح داده شده است :ref:`ssh_package_environment`.


در Antminer S9 ، می توانید ایمیج فریمور کارخانه را از وب سایت سازنده، با مسیر فایل "FACTORY_IMAGE"  
یا URL ``tar.gz`` (اکسترکت نشده!). ایمیج های پشتیبانی شده با هش MD5 مربوطه لیست شده است در فایل `platform.py <https://github.com/braiins/braiins/blob/master/braiins-os/upgrade/am1/platform.py>`__

 دستور زیر را اجرا کنید (``FACTORY_IMAGE`` و ``IP_ADDRESS`` را متناسب با مقادر خود تغییر دهید)

::

  #Antminer S9
  cd ~/braiins-os_am1-s9_ssh_2020-09-07-1-463cb8d0-20.09-plus && source .env/bin/activate
  python3 restore2factory.py --factory-image FACTORY_IMAGE IP_ADDRESS
  
  #Antminer S17
  cd ~/braiins-os_am2-s17_ssh_2020-11-27-0-5eb922d4-20.11-plus && source .env/bin/activate
  python3 restore2factory.py --factory-image FACTORY_IMAGE IP_ADDRESS

**توجه:** *برای اطلاع از آرگومانهایی که میتوانید استفاده نمایید از* **--help** *بهره ببرید*


.. _ssh_package_uninstall_backup:

استفاده از نسخه پشتیبانی که قبلا تهیه شده است
===============================================

ابتدا ، شما باید محیط پایتون را آماده کنید ، که در این بخش توضیح داده شده است :ref:`ssh_package_environment`.


 اگر شما یک پشتیبان از نسخه اصلی فریم‌ور را در مدت زمان نصب Braiins OS+ تهیه کرده باشید، شما می توانید به استفاده از دستورات زیر به آن نسخه بازگردانی کنید. (``BACKUP_ID_DATE`` و ``IP_ADDRESS`` را با مقادیر متناسب خود تغییر دهید):

::

  #Antminer S9
  cd ~/braiins-os_am1-s9_ssh_2020-09-07-1-463cb8d0-20.09-plus && source .env/bin/activate
  python3 restore2factory.py backup/BACKUP_ID_DATE/ IP_ADDRESS
  
  #Antminer S17
  cd ~/braiins-os_am2-s17_ssh_2020-11-27-0-5eb922d4-20.11-plus && source .env/bin/activate
  python3 restore2factory.py backup/BACKUP_ID_DATE/ IP_ADDRESS

** توجه: این روش توصیه نمی شود زیرا ایجاد نسخه پشتیبان بسیار دقیق است. نسخه پشتیبان تهیه شده ممکن است خراب باشد و راهی برای بررسی آن وجود ندارد. می توانید به ریسک خودتان استفاده کنید و مطمئن شوید که در صورت عدم موفقیت بازگشت ، می توانید به ماینر دسترسی پیدا کرده و کارت SD را در آن وارد کنید.**

.. _opkg:

****
OPKG
****

دستورات OPKG پس از اتصال به ماینر از طریق SSH قابل استفاده هستند. دستورات OPKG بسیاری وجود دارد ، اما در مورد Braiins OS+، شما فقط باید موارد زیر را استفاده کنید:

  * *opkg update* - لیست های بسته را به روز می کند. توصیه می شود قبل از سایر دستورات OPKG از این دستور استفاده کنید.
  * *opkg install PACKAGE_NAME* بسته تعریف شده را نصب کنید. توصیه می شود قبل از نصب بسته ها از *opkg update* برای به روزرسانی لیست های بسته استفاده کنید.
  * *opkg remove PACKAGE_NAME*

از آنجا که تغییر فریم‌ویرمنجر به ریبوت می شود ،
خروجی زیر انتظار می رود:

::

  ...
  Collected errors:
  * opkg_conf_load: Could not lock /var/lock/opkg.lock: Resource temporarily unavailable.
    Saving config files...
    Connection to 10.10.10.1 closed by remote host.
    Connection to 10.10.10.1 closed.

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + Braiins OS+ را از راه دور بروزرسانی می‌کند
  + از سایر نسخه ها از راه دور به Braiins OS+ تغییر می‌کند
  + از راه دور به نسخه اولیه Braiins OS+ برمی‌گردد
  + تنظیمات را منتقل می کند و بدون نیاز به تنظیم چیزی (هنگام بروزرسانی یا تغییر به Braiins OS+ ) به ماینینگ خود ادامه می دهد.
  
  - بدون batch-mode(مگر اینکه اسکریپت های خود را بسازید)

.. _opkg_update:

===========================================
بروزرسانی Braiins OS+ با استفاده از OPKG 
===========================================

با OPKG می توانید با اتصال به Miner از طریق SSH و استفاده از دستورات زیر ، نصب فعلی Braiins OS+ را به راحتی بروزرسانی کنید:

::

  opkg update
  opkg install bos_plus

  #همچنین میتوانید دستورات را همزمان با وصل شدن به ماینر اجرا کنید
  ssh root@IP_ADDRESS "opkg update && opkg install bos_plus"

این امر تنظیمات را منتقل می کند و بدون نیاز به تنظیم چیزی ، به ماینینگ خود ادامه می دهد.

.. _opkg_switch_to_braiinsplus:

================================================================
از نسخه‌های دیگر با استفاده از OPKG به Braiins OS+ تغییر دهید
================================================================

با OPKG می توانید با اتصال به Miner از طریق SSH و استفاده از دستورات زیر به راحتی به Braiins OS+ بروید.

::

  opkg update
  opkg install bos_plus

  #همچنین می توانید به Miner وصل شوید و همزمان دستورات را اجرا کنید
  ssh root@IP_ADDRESS "opkg update && opkg install bos_plus"

این امر تنظیمات را منتقل می کند و بدون نیاز به تنظیم چیزی ، به ماینینگ خود ادامه می دهد.

.. _opkg_factory_reset:

====================================
Braiins OS+ factory reset using OPKG
====================================

With OPKG you can easily revert to the initial version of Braiins OS+ (the version, which was installed for the first time on that device), by connecting to the miner via SSH and using the following commands:

::

  opkg update
  opkg remove firmware

  #همچنین می توانید به Miner وصل شوید و همزمان همزمان دستورات را اجرا کنید
  ssh root@IP_ADDRESS "opkg update && opkg remove firmware"

این دستور تنظیمات را به حالت اولین نصب Braiins OS+ بازنشانی میکند

.. _sysupgrade:

******************
Sysupgrade بسته
******************

‏Sysupgrade برای به روزرسانی سیستم در حال اجرا در دستگاه استفاده می شود. با استفاده از این روش می توانید نسخه های مختلف Braiins OS+ را نصب کرده یا سیستم پشتیبان تهیه کنید. نصب یک فریم‌ویر از طریق *Braiins OS+ web interface* یا  از طریق *opkg install firmware* از این روش استفاده می کند. توصیه می شود به جای این روش از *Braiins OS+ web interface* یا *opkg install firmware* استفاده کنید

==========
روش کاربرد
==========

برای استفاده از sysupgrade ، باید از طریق SSH به Miner متصل شوید. کد دستوری به شکل زیر است:

::

  sysupgrade [parameters] <image file or URL>

مهمترین پارامترها عبارتند از  **--help** (برای نمایش راهنما) و **-F** برای اجبار نصب. استفاده از این روش توصیه نمی شود (علاوه بر این روش ، در ادامه توضیح داده شده است) ، مگر اینکه واقعاً بدانید ، چه کاری انجام می دهید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

+ در حالی که به ماینر وصل است ، نسخه متفاوتی از Braiins OS+ را نصب می کند.
  + پیکربندی را انتقال میدهد.
  + پارامترها برای سفارشی کردن فرآیند در دسترس هستند
  
  - بدون حالت batch-mode (مگر اینکه اسکریپت های خود را بسازید)
  - نمی توانید به نسخه قدیمی Braiins OS+(که قبل از سال 2020 منتشر شد) تغییر دهید

.. _sysupgrade_switch_braiinsos:

==================================================================================================
از نسخه های دیگر با استفاده از Sysupgrade به  Braiins OS+ (بدون استفاده از اتوتونینگ) تغییر دهید
==================================================================================================

به منظور به روزرسانی از نسخه قدیمی Braiins OS+ یا بازگردانی از Braiins OS+، از دستور زیر استفاده کنید (به ترتیب ``IP_ADDRESS`` را جایگزین کنید):

::

  #Antminer S9
  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.org/am1-s9/firmware_2020-09-07-0-e50f2a1b-20.09_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'
  
  #Antminer S17
  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.org/am2-s17/firmware_2020-09-07-0-e50f2a1b-20.09_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'

این دستور شامل دستورات زیر میباشد: 

  * **ssh** - برای ارتباط با ماینر
  * **wget** - برای دانلود فایلها‌، برای مثال دانلود بسته‌های فریم‌ور 
  * **sysupgrade** - برای فلش کردن بسته‌های دانلود شده

.. _sysupgrade_switch_braiinsplus:

======================================================================
از نسخه های دیگر با استفاده از Sysupgrade به Braiins OS+ تغییر دهید
======================================================================

برای به روزرسانی از نسخه قدیمی Braiins OS+، از دستور زیر استفاده کنید (به ترتیب ``IP_ADDRESS`` را جایگزین کنید):

::

  #Antminer S9
  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.com/am1-s9/firmware_2020-09-07-1-463cb8d0-20.09-plus_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'
  
  #Antminer S17
  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.com/am2-s17/firmware_2020-11-27-0-5eb922d4-20.11-plus_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'
  
این دستور شامل دستورات زیر میباشد: 

  * **ssh** - برای ارتباط با ماینر
  * **wget** - برای دانلود فایلها‌، برای مثال دانلود بسته‌های فریم‌ور 
  * **sysupgrade** - برای فلش کردن بسته‌های دانلود شده

توجه: توصیه می شود به جای این روش از گزینه *BOS Toolbox*, *Braiins OS+ web interface* یا *opkg install bos_plus* استفاده کنید.

.. _bos2bos:

****************
اسکریپت Bos2Bos
****************

**اسکریپت Bos2Bos برای استفاده توصیه نمی شود ، مگر اینکه با استفاده از روش های دیگر در نصب به مشکل برخورد کنید. **  این روش تنها در صورتی کار می کند که Braiins OS+ قبلاً روی دستگاه باشد

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + هر نسخه از Braiins OS+ را از راه دور نصب می کند
  + یک نسخه تمیز ازBraiins OS+ نصب کنید
  + پارامترها برای سفارشی کردن فرآیند در دسترس هستند
  
  - بدون حالت batch-mode (مگر اینکه اسکریپت های خود را بسازید)

=======
کاربرد
=======

استفاده از اسکریپت Bos2Bos به تنظیمات زیر نیاز دارد:

* *(فقط Windows)* برای نصب *Ubuntu for Windows 10* به فروشگاه نرم‌افزار مایکروسافت مراجعه کنید `اینجا. <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6>`_
* استفاده از اسکریپت Bos2Bos به تنظیمات زیر نیاز دارد:

*(توجه داشته باشید که این دستورات برای Ubuntu و ویندوز 10 برای Ubuntu سازگار است. اگر از توزیع مختلف لینوکس یا سیستم عامل دیگری استفاده می کنید ، لطفا مستندات مربوطه را بررسی کرده و در صورت لزوم دستورات را ویرایش کنید.)*

::
  
  #بروز رسانی مخازن و نصب پیش‌نیازها
  sudo apt update && sudo apt install python3 python3-virtualenv virtualenv
  
  # تکثیر مخرن
  git clone https://github.com/braiins/braiins-os.git
  
  #تغییر پوشه
  cd ./braiins-os/braiins-os/

  #ایجاد یک virtual environment و فعال سازی آن
  virtualenv --python=/usr/bin/python3 .env && source .env/bin/activate
  
  #نصب بسته‌های لازم پایتون
  python3 -m pip install -r requirements.txt

پس از اینکه با موفقیت نصب را به پایان رساندید، میتوانید از دستور زیر استفاده کنید:

::

  #فعال سازی virtual environment
  source .env/bin/activate

  #کاربرد پایه به صورت زیر است
  python3 bos2bos.py FIRMWARE_URL IP_ADDRESS

  #توضیحات تمام پارامترهای موجود با استفاده از دستور زیر قابل مشاهده است
  python3 bos2bos.py -h

************
Miner  ابزار
************

.. _miner_nand_install:

===========================================
نصب از کارت SD به NAND از طریق ابزار Miner
===========================================

از کارت SD می توان برای جایگزینی فریم‌ویر در NAND با Braiins OS+ استفاده کرد. این کار با اتصال به Miner از طریق SSH و استفاده از دستور زیر قابل انجام است


  ::

    miner nand_install


.. _miner_factory_reset:

==================================================================
تنظیم مجدد به نسخه کارخانه Braiins OS+ با استفاده از ابزار Miner
==================================================================

تنظیم مجدد به نسخه کارخانه همچنین می تواند با استفاده از ابزار *Miner tool* انجام شود. برای انجام این کار از دستور زیر استفاده کنید:

  ::

    miner factory_reset

.. _miner_detect:

================================================
تشخیص دستگاه با استفاده از ابزار ماینر توسط LED
================================================

با استفاده از ابزار *Miner tool* می توانید دستگاه را با روشن کردن چشمک زن LED پیدا کنید. برای انجام این کار از دستور زیر استفاده کنید:

  ::

    #turn on LED blinking
    miner fault_light on

    #turn off LED blinking
    miner fault_light off

.. _miner_nightly:

==================================================================
فعال/غیرفعال سازی دریافت نسخه‌های Nightly با استفاده از ابزار Miner
==================================================================

می توانید دریافت نسخه‌های Nightly را فعال کنید تا به جدیدترین نسخه‌های Nightly به روز شوید. این نسخه‌ها با هدف رفع هرچه سریع تر موضوعات مهم و اساسی انجام می شود و به همین دلیل ، آنها به اندازه نسخه های اصلی قبل از انتشار مورد آزمایش قرار نمی گیرند. از این نسخه‌ها با احتیاط استفاده کنید و فقط در صورت حل مشکلات شما از آنها بهره گیرید. برای فعال یا غیرفعال کردن فیدهای Nightly ، از دستور زیر استفاده کنید:

  ::

    #فعال سازی nightly
    miner nightly_feeds on

    #غیرفعال سازی nightly
    miner nightly_feeds off

.. _miner_autoupgrade:

=======================================================
فعال/غیرفعال سازی امکان auto-upgrade با ابزار miner
=======================================================

شما میتوانید امکان auto-upgrade را فعال کنید، این امکان سیستم را به آخرین نسخه به صورت خودکار بروز رسانی خواهد کرد. این امکان به صورت پیشفرض هنگام نصب از **stock** **فعال** است و در صورت بروز رسانی از یکی از نسخه های **Braiins OS** یا **Braiins OS+** **غیرفعال** است. برای فعال/غیرفعال سازی دستی از دستورات زیر استفاده نمایید:

  ::

    #فعال سازی auto-upgrade
    miner auto_upgrade on

    #غیرفعال سازی auto-upgrade
    miner auto_upgrade off
