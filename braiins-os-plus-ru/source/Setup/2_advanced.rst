#######################
Расширенное руководство
#######################

.. contents::
	:local:
	:depth: 1

*************
Разветвление
*************

Существует множество инструментов, пакетов и скриптов, которые можно использовать для Braiins OS. Для лучшей навигации используйте следующее:

 * Установка Braiins OS+
 
  * Используя BOS Toolbox (:ref:`bosbox_install`)
  * Используя веб-пакет (:ref:`web_package_install`)
  * Используя SD карту (:ref:`sd_install`)
  * Используя SD карту и miner tool (:ref:`miner_nand_install`)
  * Используя SSH скрипты (:ref:`ssh_package_install`)

 * Разблокировка SSH на Antminer S9
 
  * С помощью BOS Toolbox (:ref:`bosbox_unlock`) 
  
 * Обновление Braiins OS+
 
  * Используя BOS Toolbox (:ref:`bosbox_update`)
  * Используя OPKG (:ref:`opkg_update`)
  * Используя пакет sysupgrade (:ref:`sysupgrade_switch_braiinsplus`)
  * Используя bos2bos скрипт (:ref:`bos2bos`)
  
 * Переход на Braiins OS (версия без автонастройки)
 
  * Используя пакет sysupgrade (:ref:`sysupgrade_switch_braiinsos`)
  * Используя bos2bos скрипт (:ref:`bos2bos`)
  
 * Переход на Braiins OS+ (версия с автонастройкой)
 
  * Используя OPKG (:ref:`opkg_switch_to_braiinsplus`)
  * Используя пакет sysupgrade (:ref:`sysupgrade_switch_braiinsplus`)
  * Используя bos2bos скрипт (:ref:`bos2bos`)
  
 * Сброс к исходной версии Braiins OS (версия, которая была впервые установлена на устройстве) - возврат к заводским настройкам
 
  * Используя OPKG (:ref:`opkg_factory_reset`)
  * Используя SD карту (:ref:`sd_factory_reset`)
  * Используя "miner" tool (:ref:`miner_factory_reset`)
  * Используя bos2bos скрипт (:ref:`bos2bos`)
  
 * Деинсталляция Braiins OS+
 
  * Используя BOS Toolbox (:ref:`bosbox_uninstall`)
  * Используя SSH скрипты (:ref:`ssh_package_uninstall`)

 * Включить/Выключить Nightly feeds
 
  * Используя "miner" tool (:ref:`miner_nightly`)
  
 * Включить/Выключить автоматическое обновление
 
  * Используя "miner" tool (:ref:`miner_autoupgrade`)
  
 * Выполнить пользовательские команды shell на майнере
 
  * Используя BOS Toolbox (:ref:`bosbox_command`)

.. _bosbox:

***************
BOS Toolbox
***************

BOS Toolbox - это новый инструмент, который позволяет пользователю легко устанавливать, удалять, обновлять, обнаруживать и настраивать  Braiins OS+, а также запускать пользовательские команды на устройстве. Это также позволяет делать это в пакетном режиме, что упрощает управление большим количеством устройств. BOS Toolbox также автоматически загружает последнюю версию прошивки. Это рекомендуемый способ управления вашими устройствами.

===========
Применение
===========

  * Скачайте **BOS Toolbox** с нашего `веб-сайта <https://braiins-os.com/>`_.
  * Создайте новый текстовый файл, измените ".txt" окончание на ".csv" и вставьте IP-адреса, на которых вы хотите выполнить команды. Поместите этот файл в каталог, где находится BOS Toolbox. **Используйте только один IP-адрес в строке!**
  * Следуйте разделам ниже

=========================================
Особенности, плюсы и минусы этого метода:
=========================================

  + дистанционная установка Braiins OS+ и автоматическая разблокировка SSH на Antminer S9 во время установки
  + дистанционное обновление Braiins OS+
  + дистанционное удаление Braiins OS+
  + дистанционная конфигурация Braiins OS+
  + запуск пользовательских команд на машинах
  + сканирование сети на наличие устройств
  + переносит всю конфигурацию по умолчанию (можно настроить) при установке Braiins OS+
  + переносит конфигурацию сети по умолчанию (можно настроить) при удалении Braiins OS+
  + параметры доступны для настройки процесса
  + настраивает ограничения мощности по умолчанию для автонастройки при установке Braiins OS+
  + пакетный режим доступен для управления несколькими устройствами одновременно
  + простота использования
  
  - не работает на майнерах x17 серии с заблокированным SSH

.. _bosbox_install:

===================================================
Установка Braiins OS с помощью BOS Toolbox
===================================================

  * Скачайте **BOS Toolbox** с нашего `веб-сайта <https://braiins-os.com/>`_.
  * Создайте новый текстовый файл, измените ".txt" окончание на ".csv" и вставьте IP-адреса, на которых вы хотите выполнить команды. Поместите этот файл в каталог, где находится BOS Toolbox. Используйте только один IP-адрес в строке!
  * После того, как вы загрузили BOS Toolbox, откройте командную строку (например, CMD для Windows, Terminal для Ubuntu и т.д.)
  * Замените *FILE_PATH_TO_BOS_TOOLBOX* заполнитель в приведенной ниже команде с фактическим путем к файлу, в котором вы сохранили BOS Toolbox. Затем переключитесь на путь к файлу, выполнив команду: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * Теперь замените *listOfMiners.csv* заполнитель с вашим именем файла в команде ниже и выполните соответствующую команду для вашей операционной системы:

    Для командной строки **Windows**: ::

      bos-toolbox.bat install ARGUMENTS HOSTNAME
    
    Для командной строки **Linux**: ::
      
      ./bos-toolbox install ARGUMENTS HOSTNAME

    **Примечание:** *при использовании BOS Toolbox для Linux вам нужно сделать его исполняемым с помощью следующей команды (это нужно сделать только один раз):* ::
  
      chmod u+x ./bos-toolbox

Вы можете использовать следующие **аргументы**, чтобы настроить процесс:

**Важная заметка:** 
При установке Braiins OS+ на **одно устройство**, используйте аргумент *HOSTNAME* (IP-адрес).
При установке Braiins OS+ на **несколько устройств**, **НЕ** используйте аргумент HOSTNAME, вместо этого, используйте аргумент *--batch BATCH*.

====================================  ===============================================================================
Аргументы                             Описание
====================================  ===============================================================================
-h, --help                            показать это справочное сообщение и выйти
--open-source         		            использовать для установки версии с открытым исходным кодом (кроме **nightly** и **feed-url**)
--nightly             		            использовать для установки ночной версии (кроме **open-source** и **feed-url**)
--feeds-url [FEEDS_URL]		            переопределить URL-адрес сервера каналов по умолчанию (кроме **open-source** и **nightly**)
--fw-version [FW_VERSION]	            select specific firmware version
--backup                              сделать резервную копию майнера перед обновлением
--no-auto-upgrade                     отключить автообновление установленной прошивки
--no-nand-backup                      пропустить полное резервное копирование NAND (конфигурация все еще копируется)
--pool-user [POOL_USER]               установить имя пользователя и воркера для пула по умолчанию
--psu-power-limit [PSU_POWER_LIMIT]   установить предел мощности блока питания (в ваттах)
--no-keep-network                     не сохранять конфигурацию сети майнера (использование DHCP)
--no-keep-pools                       не сохранять конфигурацию пула
--no-keep-hostname                    не сохраняйте имя хоста и генерировать новое на основе MAC
--keep-hostname                       заставить оставлять любое имя хоста
--no-wait                             не ждать, пока система полностью обновится
--dry-run                             сделать все шаги обновления без фактического обновления
--post-upgrade [POST_UPGRADE]         путь к каталогу с stage3.sh скриптом
--install-password INSTALL_PASSWORD   ssh пароль для установки
--bos-mgmt-id [BOS_MGMT_ID]	          установить идентификатор для BOS management
-p PASSWORD, --password PASSWORD      пароль администратора
====================================  ===============================================================================

**Пример:**

::

  bos-toolbox.bat install --password root listOfMiners.csv

Эта команда установит Braiins OS+ на майнеры, указанные в файле *listOfMiners.csv*, и установит ограничение мощности 1200 для всех из них. Команда также автоматически разблокирует Antminer S9 и вставит пароль SSH *admin*, когда майнер запросит его.

.. _bosbox_update:

==============================================
Обновление Braiins OS+ с помощью BOS Toolbox
==============================================

  * Скачайте **BOS Toolbox** с нашего `веб-сайта <https://braiins-os.com/plus/download/>`_.
  * Создайте новый текстовый файл, измените ".txt" окончание на ".csv" и вставьте IP-адреса, на которых вы хотите выполнить команды. Поместите этот файл в каталог, где находится BOS Toolbox.
  * После того, как вы загрузили BOS Toolbox, откройте командную строку (например, CMD для Windows, Terminal для Ubuntu и т.д.)
  * Замените *FILE_PATH_TO_BOS_TOOLBOX* заполнитель в приведенной ниже команде с фактическим путем к файлу, в котором вы сохранили BOS Toolbox. Затем переключитесь на путь к файлу, выполнив команду: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * Теперь замените *listOfMiners.csv* заполнитель с вашим именем файла в команде ниже и выполните соответствующую команду для вашей операционной системы:

    Для командной строки **Windows**: ::

      bos-toolbox.bat update ARGUMENTS HOSTNAME

    Для командной строки **Linux**: ::
      
      ./bos-toolbox update ARGUMENTS HOSTNAME

     **Примечание:** *при использовании BOS Toolbox для Linux вам нужно сделать его исполняемым с помощью следующей команды (это нужно сделать только один раз):* ::
  
      chmod u+x ./bos-toolbox

Вы можете использовать следующие **аргументы**, чтобы настроить процесс:

**Важная заметка:** 
При установке Braiins OS+ на **одно устройство**, используйте аргумент *HOSTNAME* (IP-адрес).
При установке Braiins OS+ на **несколько устройств**, **НЕ** используйте аргумент HOSTNAME, вместо этого, используйте аргумент *--batch BATCH*.

====================================  ============================================================
Аргументы                             Описание
====================================  ============================================================
--h, --help                           показать это справочное сообщение и выйти
-p PASSWORD, --password PASSWORD      пароль администратора
-i, --ignore                          не останавливаться на ошибках
====================================  ============================================================


**Пример:**

::

  bos-toolbox.bat update listOfMiners.csv

Эта команда будет искать обновление для майнеров, указанных в *listOfMiners.csv*, и обновлять их, если появится новая версия прошивки.

.. _bosbox_uninstall:

================================================
Деинсталляция Braiins OS с помощью BOS Toolbox
================================================

  * Скачайте **BOS Toolbox** с нашего `веб-сайта <https://braiins-os.com/plus/download/>`_.
  * Создайте новый текстовый файл в своем текстовом редакторе и вставьте IP-адреса, на которых вы хотите выполнить команды. Каждый IP-адрес должен быть разделен запятой. (Обратите внимание, что вы можете найти IP-адрес в веб-интерфейсе Braiins OS, перейдя в *Status -> Overview*.) Затем сохраните файл в том же каталоге, в котором вы сохранили BOS Toolbox, и измените ".txt" окончание на ".csv".
  * После того, как вы загрузили BOS Toolbox и сохранили .csv фаил, откройте командную строку (например, CMD для Windows, Terminal для Ubuntu и т.д.)
  * Замените *FILE_PATH_TO_BOS_TOOLBOX* заполнитель в приведенной ниже команде с фактическим путем к файлу, в котором вы сохранили BOS Toolbox. Затем переключитесь на путь к файлу, выполнив команду: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * Теперь замените *listOfMiners.csv* заполнитель с вашим именем файла в команде ниже и выполните соответствующую команду для вашей операционной системы:

     Для командной строки **Windows**: ::

      bos-toolbox.bat uninstall ARGUMENTS HOSTNAME

     Для командной строки **Linux**: ::
      
      ./bos-toolbox uninstall ARGUMENTS HOSTNAME
      
    **Примечание:** *при использовании BOS Toolbox для Linux вам нужно сделать его исполняемым с помощью следующей команды (это нужно сделать только один раз):* ::
  
      chmod u+x ./bos-toolbox

Вы можете использовать следующие **аргументы**, чтобы настроить процесс:

**Важная заметка:** 
При установке Braiins OS+ на **одно устройство**, используйте аргумент *HOSTNAME* (IP-адрес).
При установке Braiins OS+ на **несколько устройств**, **НЕ** используйте аргумент HOSTNAME, вместо этого, используйте аргумент *--batch BATCH*.

====================================  ============================================================
Аргументы                             Описание
====================================  ============================================================
-h, --help                            показать это справочное сообщение и выйти
-p PASSWORD, --password PASSWORD      пароль администратора
--feeds-url [FEEDS_URL]		            переопределить URL-адрес сервера каналов по умолчанию
--nand-restore			                  использовать полное восстановление NAND из предыдущей резервной копии
====================================  ============================================================

**Пример:**

::

  bos-toolbox.bat uninstall listOfMiners.csv

Эта команда удалит Braiins OS+ из майнеров, указанных в файле *listOfMiners.csv*, и установит стандартную прошивку по умолчанию.

**Предупреждение:** стандартная прошивка, которая устанавливается при удалении Braiins OS+, не подходит для майнинга! Перед началом майнинга обновите стандартную прошивку до более новой версии для вашей конкретной модели оборудования.

.. _bosbox_configure:

==============================================
Настройка  Braiins OS с помощью BOS Toolbox
==============================================

  * Скачайте **BOS Toolbox** с нашего `веб-сайта <https://braiins-os.com/plus/download/>`_.
  * Создайте новый текстовый файл в своем текстовом редакторе и вставьте IP-адреса, на которых вы хотите выполнить команды. Каждый IP-адрес должен быть разделен запятой. (Обратите внимание, что вы можете найти IP-адрес в веб-интерфейсе Braiins OS, перейдя в *Status -> Overview*.) Затем сохраните файл в том же каталоге, в котором вы сохранили BOS Toolbox, и измените ".txt" окончание на ".csv".
  * После того, как вы загрузили BOS Toolbox и сохранили .csv фаил, откройте командную строку (например, CMD для Windows, Terminal для Ubuntu и т.д.)
  * Замените *FILE_PATH_TO_BOS_TOOLBOX* заполнитель в приведенной ниже команде с фактическим путем к файлу, в котором вы сохранили BOS Toolbox. Затем переключитесь на путь к файлу, выполнив команду: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  *Теперь замените *listOfMiners.csv* заполнитель с вашим именем файла в команде ниже и выполните соответствующую команду для вашей операционной системы:

    Для командной строки **Windows**: ::

      bos-toolbox.bat config ARGUMENTS ACTION TABLE

     Для командной строки **Linux**: ::
      
      ./bos-toolbox config ARGUMENTS ACTION TABLE
      
    **Примечание:** *при использовании BOS Toolbox для Linux вам нужно сделать его исполняемым с помощью следующей команды (это нужно сделать только один раз):* ::
  
      chmod u+x ./bos-toolbox

Вы можете использовать следующие **аргументы**, чтобы настроить процесс:

====================================  ============================================================
Аргументы                             Описание
====================================  ============================================================
-h, --help                            показать это справочное сообщение и выйти
-u USER, --user USER                  Имя пользователя администратора
-p PASSWORD, --password PASSWORD      Пароль администратора или "prompt"
-P, --change-password		      разрешить изменение пароля (на тот, который указан в *listOfMiners.csv*)
-c, --check                           пробный прогон sans 
-i, --ignore                          не останавливаться на ошибках
====================================  ============================================================

Вам **необходимо использовать одно** из следующих **действий** чтобы отрегулировать процесс:

====================================  ============================================================
Аргументы                             Описание
====================================  ============================================================
load                                  загрузить текущую конфигурацию майнеров (указанную в 
                                      файле CSV) и вставить их в файл CSV
save                                  сохранить настройки из файла CSV для майнеров 
                                      (без применения)
apply                                 применить настройки, которые были скопированы из файла CSV к 
                                      майнерам
save_apply                            сохранить и применить настройки из файла CSV к майнерам
====================================  ============================================================

**Пример:**

::

  bos-toolbox.bat config --user root load listOfMiners.csv
  
  #отредактируйте файл CSV с помощью редактора электронных таблиц (например: Office Excel, LibreOffice Calc, etc.)
  
  bos-toolbox.bat config --user root -p admin -P save_apply listOfMiners.csv

Первая команда загрузит конфигурацию майнеров, указанную в *listOfMiners.csv* (используя логин *root*) и сохранит ее в CSV-файле. Теперь вы можете открыть файл и редактировать то, что вам нужно. После редактирования файла вторая команда скопирует настройки обратно в майнеры, применит их и изменит пароль на пароль в столбце пароля.

.. _bosbox_scan:

===============================================================
Сканирование сети для выявления майнеров с помощью BOS Toolbox
===============================================================

  * Скачайте **BOS Toolbox** с нашего `веб-сайта <https://braiins-os.com/plus/download/>`_.
  * Создайте новый текстовый файл в своем текстовом редакторе и вставьте IP-адреса, на которых вы хотите выполнить команды. Каждый IP-адрес должен быть разделен запятой. (Обратите внимание, что вы можете найти IP-адрес в веб-интерфейсе Braiins OS, перейдя в *Status -> Overview*.) Затем сохраните файл в том же каталоге, в котором вы сохранили BOS Toolbox, и измените ".txt" окончание на ".csv".
  * После того, как вы загрузили BOS Toolbox и сохранили .csv фаил, откройте командную строку (например, CMD для Windows, Terminal для Ubuntu и т.д.)
  * Замените *FILE_PATH_TO_BOS_TOOLBOX* заполнитель в приведенной ниже команде с фактическим путем к файлу, в котором вы сохранили BOS Toolbox. Затем переключитесь на путь к файлу, выполнив команду: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * Теперь замените *listOfMiners.csv* заполнитель с вашим именем файла в команде ниже и выполните соответствующую команду для вашей операционной системы:


    Для командной строки **Windows**: ::

      bos-toolbox.bat discover ARGUMENTS

     Для командной строки **Linux**: ::
      
      ./bos-toolbox discover ARGUMENTS
      
    **Примечание:** *при использовании BOS Toolbox для Linux вам нужно сделать его исполняемым с помощью следующей команды (это нужно сделать только один раз):* ::
  
      chmod u+x ./bos-toolbox

Вы можете использовать следующие **аргументы**, чтобы настроить процесс:

====================================  ============================================================
Аргументы                             Описание
====================================  ============================================================
-h, --help                            показать это справочное сообщение и выйти
====================================  ============================================================

Вам **необходимо использовать одно** из следующих **действий** чтобы отрегулировать процесс:

====================================  ============================================================
Аргументы                             Описание
====================================  ============================================================
scan                                  активно сканировать предоставленный диапазон адресов
listen                                прослушивание входящей трансляции с устройств
                                      (при нажатии кнопки отчета IP)
====================================  ============================================================

====================================  ============================================================
Optional Arguments - scan             Description
====================================  ============================================================
-h, --help                            show this help message and exit
--passwords PASSWORDS                 path to file with list of possible passwords for connection
-o OUTPUT, --output OUTPUT            save list of found IP addresses to file
-j JOBS, --jobs JOBS                  number of concurrent jobs to scan network
-v, --verbose                         Report networking errors
====================================  ============================================================

====================================  ============================================================
Optional Arguments - listen             Description
====================================  ============================================================
-h, --help                            show this help message and exit
-o OUTPUT, --output OUTPUT            save list of found IP addresses to file
--format FORMAT                       change default formatting string for device information; the
                                      tags '{IP}' and '{MAC}' will be replaced with actual data
====================================  ============================================================

**Пример:**

::

  #scan the network, in the range 10.10.10.0 - 10.10.10.255
  bos-toolbox.bat discover scan 10.10.10.0/24

  #scan the network, in the range 10.10.0.0 - 10.10.255.255
  bos-toolbox.bat discover scan 10.10.0.0/16

  #scan the network, in the range 10.0.0.0 - 10.255.255.255
  bos-toolbox.bat discover scan 10.0.0.0/8
  
.. _bosbox_command:

=============================================================
Пользовательские команды на майнерах, используя BOS Toolbox
=============================================================

  * Скачайте **BOS Toolbox** с нашего `веб-сайта <https://braiins-os.com/plus/download/>`_.
  * Создайте новый текстовый файл в своем текстовом редакторе и вставьте IP-адреса, на которых вы хотите выполнить команды. Каждый IP-адрес должен быть разделен запятой. (Обратите внимание, что вы можете найти IP-адрес в веб-интерфейсе Braiins OS, перейдя в *Status -> Overview*.) Затем сохраните файл в том же каталоге, в котором вы сохранили BOS Toolbox, и измените ".txt" окончание на ".csv".
  * После того, как вы загрузили BOS Toolbox и сохранили .csv фаил, откройте командную строку (например, CMD для Windows, Terminal для Ubuntu и т.д.)
  * Замените *FILE_PATH_TO_BOS_TOOLBOX* заполнитель в приведенной ниже команде с фактическим путем к файлу, в котором вы сохранили BOS Toolbox. Затем переключитесь на путь к файлу, выполнив команду: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * Теперь замените *listOfMiners.csv* заполнитель с вашим именем файла в команде ниже и выполните соответствующую команду для вашей операционной системы:

    Для командной строки **Windows**: ::

      bos-toolbox.bat command ARGUMENTS TABLE COMMAND

    Для командной строки **Linux**: ::
    
      ./bos-toolbox command ARGUMENTS TABLE COMMAND
      
     **Примечание:** *при использовании BOS Toolbox для Linux вам нужно сделать его исполняемым с помощью следующей команды (это нужно сделать только один раз):* ::
  
      chmod u+x ./bos-toolbox

Вы можете использовать следующие **аргументы**, чтобы настроить процесс:

====================================  ============================================================
Аргументы                             Описание
====================================  ============================================================
-h, --help                            показать это справочное сообщение и выйти
-a, --auto                            использовать ssh, если rpc недоступен
-l, --legacy                          использовать ssh
-L, --no-legacy                       использовать rpc
-o, --output                          Захват и печать удаленного вывода
-O, --output-hostname                 Захват и печать удаленного вывода
-p PASSWORD, --password PASSWORD      Пароль администратора
-j JOBS, --jobs JOBS                  количество одновременных заданий
====================================  ============================================================

Вам **необходимо использовать одно** из следующих **действий** чтобы отрегулировать процесс:

====================================  ============================================================
Команды                               Описание
====================================  ============================================================
start                                 Запуск BOSminer
stop                                  Остановка BOSminer
*custom_shell_command*                Замените *custom_shell_command* вашей shell командой 
                                      (например *cat /etc/bosminer.toml* чтобы показать содержание 
                                      конфигурационного файла *bosminer.toml*
====================================  ============================================================

**Пример:**

::

  #остановить BOSminer, эффективно останавливая майнинг и уменьшая потребляемую мощность до минимума
  bos-toolbox.bat command -o list.csv stop 

.. _bosbox_unlock:

=======================================================
Разблокировка SSH на Antminer S9 с помощью BOS Toolbox
=======================================================

  * Скачайте **BOS Toolbox** с нашего `веб-сайта <https://braiins-os.com/plus/download/>`_.
  * Создайте новый текстовый файл, измените ".txt" окончание на ".csv" и вставьте IP-адреса, на которых вы хотите выполнить команды. Поместите этот файл в каталог, где находится BOS Toolbox. **Используйте только один IP-адрес в строке!**
  * После того, как вы загрузили BOS Toolbox, откройте командную строку (например, CMD для Windows, Terminal для Ubuntu и т.д.) 
  * Замените *FILE_PATH_TO_BOS_TOOLBOX* заполнитель в приведенной ниже команде с фактическим путем к файлу, в котором вы сохранили BOS Toolbox. Затем переключитесь на путь к файлу, выполнив команду: ::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * Теперь замените *listOfMiners.csv* заполнитель с вашим именем файла в команде ниже и выполните соответствующую команду для вашей операционной системы:

    Для командной строки **Windows**: ::

      bos-toolbox.bat unlock ARGUMENTS HOSTNAME

    Для командной строки **Linux**: ::
      
      ./bos-toolbox unlock ARGUMENTS HOSTNAME

    **Примечание:** *при использовании BOS Toolbox для Linux, вам нужно сделать его исполняемым с помощью следующей команды (это нужно сделать только один раз):* ::
  
      chmod u+x ./bos-toolbox

Вы можете использовать следующие **аргументы**, чтобы настроить процесс:

**Важная заметка:** 
При установке Braiins OS+ на **одно устройство**, используйте аргумент *HOSTNAME* (IP address).
При установке Braiins OS+ на **несколько устройств**, **НЕ** используйте аргумент *HOSTNAME*, вместо этого, используйте аргумент *--batch BATCH*.

====================================  ============================================================
Аргументы                             Описание
====================================  ============================================================
--h, --help                           Показать это справочное сообщение и выйти
-u USERNAME, --username USERNAME      Имя пользователя для веб-интерфейса
-p PASSWORD, --password PASSWORD      Пароль для веб-интерфейса
--port PORT                           Порт antminer веб-интерфейса
--ssl                                 Если использовать SSL
====================================  ============================================================


**Пример:**

::

  bos-toolbox.bat unlock -p root listOfMiners.csv

Эта команда разблокирует SSH на майнерах, указанных в *listOfMiners.csv*.

.. _web_package:

***********
Веб-пакет
***********

Веб-пакет можно использовать для переключения со стоковой прошивки, выпущенной до 2019 года. Он также должен работать на других прошивках, основанных на стоковой версии. Этот пакет нельзя использовать на стоковой прошивке, выпущенной в 2019 году и позже, из-за проверки подписи, которая была реализована. Проверка подписи предотвращает использование иных, чем оригинальные стоковые прошивки.

==========
Применение
==========

  * Скачайте **Веб-пакет** с нашего `веб-сайта <https://braiins-os.com/>`_.
  * Следуйте разделам ниже

=========================================
Особенности, плюсы и минусы этого метода:
=========================================

  + заменяет стоковую прошивку на Braiins OS+ без использования дополнительных инструментов
  + переносит конфигурацию сети
  + переносит пул URL, имена пользователей и пароли
  + настраивает ограничения мощности по умолчанию для автонастройки
  
  - не может использоваться на стоковой прошивке, выпущенной в 2019 году и позже
  - невозможно настроить установку (например, он всегда будет переносить настройки сети)
  - нет пакетного режима (для массовой установки), если вы не создаете свои собственные скрипты

.. _web_package_install:

===========================================
Установите Braiins OS+ с помощью веб-пакета
===========================================

  * Скачайте **Веб-пакет** с нашего `веб-сайта <https://braiins-os.com/>`_.
  * Войдите на свой майнер и перейдите в раздел *System -> Upgrade*.
  * Загрузите загруженный пакет и прошейте образ.

.. _sd:

***************
Образ SD карты
***************

Если вы используете стандартную прошивку, выпущенную в 2019 году и позже, единственный способ установить Braiins OS+ - это вставить SD-карту с прошивкой Braiins OS+. В 2019 году SSH-соединение было заблокировано, и проверка подписи в веб-интерфейсе предотвращает использование других программных прошивок.

==========
Применение
==========

  * Скачайте **Образ SD карты** с нашего `веб-сайта <https://braiins-os.com/>`_.
  * Следуйте разделам ниже

=========================================
Особенности, плюсы и минусы этого метода:
=========================================

  + заменяет SSH заблокированную стоковую прошивку на Braiins OS+
  + использует конфигурацию сети, хранящуюся в NAND (это можно отключить, см. раздел *Настройки сети* ниже)
  + настраивает ограничения мощности по умолчанию для автонастройки
  
  - не переносит пул URL, имена пользователей и пароли
  - нет пакетного режима (для массовой установки)

.. _sd_install:

========================================
Установка Braiins OS+ с помощью SD карты
========================================

 * Скачайте Образ SD карты с нашего `веб-сайта <https://braiins-os.com/>`_.
 * Перенесите загруженный образ на SD-карту (например, используя `Etcher <https://etcher.io/>`_). *Примечание. Простое копирование на SD-карту не будет работать. SD-карта должна быть перепрошита!*
 * **(Только Antminer S9)** Настройте перемычки для загрузки с SD-карты (вместо памяти NAND), как показано ниже.

  .. |pic1| image:: ../_static/s9-jumpers.png
      :width: 45%
      :alt: S9 Jumpers

  .. |pic2| image:: ../_static/s9-jumpers-board.png
      :width: 45%
      :alt: S9 Jumpers Board

  |pic1|  |pic2|

 * Вставьте SD-карту в устройство, затем запустите устройство.
 * Через некоторое время вы сможете получить доступ к интерфейсу Braiins OS+ через IP-адрес устройства.
 * Если использовалась автоматически устанавливаемая версия образа SD, система будет автоматически установлена во внутреннюю память (NAND). Установка завершена, когда оба светодиода начнут мигать одновременно. После завершения установки извлеките SD-карту, чтобы загрузить Braiins OS+ из NAND.

.. _sd_network:

================
Настройки сети
================
 
 По умолчанию используется конфигурация сети, хранящаяся в NAND, при запуске Braiins OS+ с SD-карты. Эта функция может быть отключена, следуя инструкциям ниже:

  * Смонтируйте первый раздел FAT на SD-карте
  * Откройте файл uEnv.txt и вставьте следующий стринг (убедитесь, что в на каждой строке только один стринг)

  ::

    cfg_override=no

Отключение использования старых сетевых настроек полезно для пользователей, у которых есть проблемы с тем, что майнер не виден в сети (например, статический IP-адрес, используемый в NAND, находится вне зоны действия сети). При этом используется DHCP.

.. _sd_nand_install:

===============
NAND установка
===============

SD-карту можно использовать для замены встроенного программного обеспечения NAND на Braiins OS+. Это можно сделать либо:
  * Добавьте ``nand_install=yes`` в ``uEnv.txt`` файл для автоматической установки NAND.
  * используя веб-интерфейс - раздел *System -> Install current system to device (NAND)*
  * используя *miner* tool через SSH - следуйте этому разделу руководства :ref:`miner_nand_install`

.. _sd_factory_reset:

=============================================
Braiins OS+ сброс настроек с помощью SD-карты
=============================================

Вы можете сделать сброс до заводских настроек, следуя инструкциям ниже:

  * Смонтируйте первый раздел FAT на SD-карте
  * Откройте файл uEnv.txt и вставьте следующий стринг (убедитесь, что в на каждой строке только один стринг)

  ::

    factory_reset=yes

.. _ssh_package:

********************************
Пакет удаленной установки (SSH)
********************************

С помощью *Пакета удаленной установки (SSH)* вы можете установить или удалить Braiins OS+. Этот метод не рекомендуется, так как требует установки Python. Вместо этого используйте BOS Toolbox.

===========
Применение
===========

  * Скачайте **Пакет удаленной установки (SSH)** с нашего `веб-сайта <https://braiins-os.com/>`_.
  * Следуйте разделам ниже

=========================================
Особенности, плюсы и минусы этого метода:
=========================================

  + дистанционная установка Braiins OS+
  + дистанционное удаление Braiins OS+
  + переносит всю конфигурацию по умолчанию (можно настроить) при установке Braiins OS+
  + переносит конфигурацию сети по умолчанию (можно настроить) при удалении Braiins OS+
  + параметры доступны для настройки процесса
  + настраивает ограничения мощности по умолчанию для автонастройки при установке Braiins OS+
  
  - нет пакетного режима (для массовой установки), если вы не создаете свои собственные скрипты
  - требует долгой установки
  - не работает на майнере с заблокированным SSH

.. _ssh_package_environment:

===========================
Подготовка среды
===========================

Во-первых, вам нужно подготовить среду Python. Это состоит из следующих шагов:

* *(Только Windows)* Устонавите *Ubuntu for Windows 10* доступный в Microsoft Store `здесь. <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6>`_
* Выполните следующие команды в терминале командной строки:

*(Обратите внимание, что команды совместимы с Ubuntu и Ubuntu для Windows 10. Если вы используете другой дистрибутив Linux или другую ОС, пожалуйста, ознакомьтесь с соответствующей документацией и отредактируйте команды при необходимости.)*

::

  #Обновите репозитории и установите зависимости
  sudo apt update && sudo apt install python3 python3-virtualenv virtualenv
  
  #Скачайте и распакуйте пакет прошивки
  #Antminer S9
  wget -c https://feeds.braiins-os.com/20.10/braiins-os_am1-s9_ssh_2020-10-25-0-908ca41d-20.10-plus.tar.gz -O - | tar -xz
  
  #Antminer S17
  wget -c https://feeds.braiins-os.com/20.11/braiins-os_am2-s17_ssh_2020-11-27-0-5eb922d4-20.11-plus.tar.gz -O - | tar -xz

  #Измените каталог на распакованную папку с прошивкой
  #Antminer S9
  cd ./braiins-os_am1-s9_ssh_VERSION
  
  #Antminer S17
  cd ./braiins-os_am2-s17_ssh_VERSION

  #Создайте виртуальную среду и активируйте ее
  virtualenv --python=/usr/bin/python3 .env && source .env/bin/activate
  
  #Установите необходимые пакеты Python
  python3 -m pip install -r requirements.txt

.. _ssh_package_install:

==========================================
Установка Braiins OS+ с помощью SSH-пакета
==========================================

Установка Braiins OS+ с использованием так называемого *Метода SSH* состоит из следующих шагов:

* *(Кастомная прошивка)* Перепрошейте на заводскую прошивкую Этот шаг можно пропустить, если устройство работает на заводской прошивке или на предыдущих версиях Braiins OS. *(Примечание: вполне возможно, что Braiins OS+ может быть установлен непосредственно поверх кастомной прошивки, но, поскольку они отличаются от стоковой версии, может потребоваться сначала прошить стоковую прошивку.)*
* *(Только Windows)* Установите *Ubuntu for Windows 10* оступный в Microsoft Store `здесь. <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6>`_
* Подготовьте среду Python, которая описана в разделе :ref:`ssh_package_environment`.
* Выполните следующие команды в терминале командной строки (заменить заполнитель ``IP_ADDRESS`` соответственно) :

*(Обратите внимание, что команды совместимы с Ubuntu и Ubuntu для Windows 10. Если вы используете другой дистрибутив Linux или другую ОС, пожалуйста, ознакомьтесь с соответствующей документацией и отредактируйте команды при необходимости.)*

::

  #Измените каталог на распакованную папку с прошивкой (если ее еще нет в папке с прошивкой)
  #Antminer S9
  cd ./braiins-os_am1-s9_ssh_VERSION
  
  #Antminer S17
  cd ./braiins-os_am2-s17_ssh_VERSION

  #Активируйте виртуальную среду (если она еще не активирована)
  source .env/bin/activate
  
  #Запустите скрипт для установки Braiins OS+
  python3 upgrade2bos.py IP_ADDRESS

**Примечание:** *для получения дополнительной информации об аргументах, которые можно использовать, используйте* **--help** *аргумент.*

.. _ssh_package_uninstall:

==============================================
Деинсталляция Braiins OS+ с помошью SSH-пакета
==============================================

.. _ssh_package_uninstall_image:

Использование заводского образа прошивки
=========================================

Во-первых, вам нужно подготовить среду Python, которая описана в разделе :ref:`ssh_package_environment`.

На Antminer S9, вы можете прошить заводской образ прошивки с сайта производителя, с тем, что``FACTORY_IMAGE`` это bпуть к файлу или URL к ``tar.gz`` (не извлеченному!) файлу. Поддерживаемые изображения с соответствующими хэшами MD5 перечислены в
`platform.py <https://github.com/braiins/braiins/blob/master/braiins-os/upgrade/am1/platform.py>`__
файле.

Запустите (заменив заполнители ``FACTORY_IMAGE`` и ``IP_ADDRESS`` соответственно):

::

  #Antminer S9
  cd ~/braiins-os_am1-s9_ssh_2020-09-07-1-463cb8d0-20.09-plus && source .env/bin/activate
  python3 restore2factory.py --factory-image FACTORY_IMAGE IP_ADDRESS
  
  #Antminer S17
  cd ~/braiins-os_am2-s17_ssh_2020-11-27-0-5eb922d4-20.11-plus && source .env/bin/activate
  python3 restore2factory.py --factory-image FACTORY_IMAGE IP_ADDRESS

**Примечание:** *для получения дополнительной информации об аргументах, которые можно использовать, используйте* **--help** *аргумент.*

.. _ssh_package_uninstall_backup:

Использование ранее созданной резервной копии
=============================================

Во-первых, вам нужно подготовить среду Python, которая описана в разделе :ref:`ssh_package_environment`.

Если вы создали резервную копию оригинальной прошивки во время установки Braiins OS+, вы можете восстановить ее с помощью следующих команд (замените заполнители ``BACKUP_ID_DATE`` и ``IP_ADDRESS`` соответственно):

::

  #Antminer S9
  cd ~/braiins-os_am1-s9_ssh_2020-09-07-1-463cb8d0-20.09-plus && source .env/bin/activate
  python3 restore2factory.py backup/BACKUP_ID_DATE/ IP_ADDRESS
  
  #Antminer S17
  cd ~/braiins-os_am2-s17_ssh_2020-11-27-0-5eb922d4-20.11-plus && source .env/bin/activate
  python3 restore2factory.py backup/BACKUP_ID_DATE/ IP_ADDRESS

**Примечание: Этот метод не рекомендуется, так как создание резервной копии очень сложно. Резервная копия может быть повреждена, и проверить ее невозможно. Используйте на свой страх и риск и убедитесь, что вы можете получить доступ к майнеру и вставить в него SD-карту, если восстановление не завершится успешно!**

.. _opkg:

****
OPKG
****

OPKG команды можно использовать после подключения к майнеру через SSH. Существует много команд OPKG, но в отношении Braiins OS+ вам нужно использовать только следующее:

  * *opkg update* - обновляет списки пакетов. Рекомендуется использовать эту команду перед другими командами OPKG.
  * *opkg install PACKAGE_NAME* установить определенный пакет. Рекомендуется использовать *opkg update* для обновления списков пакетов перед установкой пакетов.
  * *opkg remove PACKAGE_NAME*

Поскольку смена прошивки приводит к перезагрузке, ожидается следующий вывод:

::

  ...
  Collected errors:
  * opkg_conf_load: Could not lock /var/lock/opkg.lock: Resource temporarily unavailable.
    Saving config files...
    Connection to 10.10.10.1 closed by remote host.
    Connection to 10.10.10.1 closed.

=========================================
Особенности, плюсы и минусы этого метода:
=========================================

  + дистанционное обновление Braiins OS+
  + дистанционный переход на Braiins OS+ с других версий
  + дистанционный возврат к первоначальной версии of Braiins OS
  + перенос конфигурации и продолжение майнинга без необходимости что-либо настраивать (при обновлении или переходе на Braiins OS+ с других версий)
  
  - нет пакетного режима (для массовой установки), если вы не создаете свои собственные скрипты

.. _opkg_update:

=====================================
Обновление Braiins OS+ с помощью OPKG
=====================================

С OPKG вы можете легко обновить текущую установку Braiins OS+, подключившись к майнеру через SSH и используя следующие команды:

::

  opkg update
  opkg install firmware

  #Вы также можете подключиться к майнеру и одновременно запускать команды
  ssh root@IP_ADDRESS "opkg update && opkg install firmware"

Это перенесет конфигурацию и продолжит работу без необходимости что-либо настраивать.

.. _opkg_switch_to_braiinsplus:

=====================================================
Переход на Braiins OS+ с другой версии с помощью OPKG
=====================================================

С OPKG вы можете легко переключиться на Braiins OS+, подключившись к майнеру через SSH и используя следующие команды:

::

  opkg update
  opkg install bos_plus

  #Вы также можете подключиться к майнеру и одновременно запускать команды
  ssh root@IP_ADDRESS "opkg update && opkg install bos_plus"

Это перенесет конфигурацию и продолжит работу без необходимости что-либо настраивать. Предел мощности по умолчанию будет установлен на 1420W.

.. _opkg_factory_reset:

=========================================
Braiins OS+ сброс настроек с помощью OPKG
=========================================

С помощью OPKG вы можете легко вернуться к первоначальной версии Braiins OS (версии, которая была впервые установлена на этом устройстве), подключившись к майнеру по SSH и используя следующие команды:

::

  opkg update
  opkg remove firmware

  #Вы также можете подключиться к майнеру и одновременно запускать команды
  ssh root@IP_ADDRESS "opkg update && opkg remove firmware"

Это вернет конфигурацию в состояние после первой установки Braiins OS.

.. _sysupgrade:

******************
Sysupgrade пакет
******************

Sysupgrade используется для обновления системы, работающей на устройстве. С помощью этого метода вы можете установить различные версии Braiins OS или создать резервную копию системы. При установке прошивки с использованием *Braiins OS веб интерфейс* или *opkg install firmware* используется этот метод. Вместо этого метода рекомендуется использовать *Braiins OS веб интерфейс* или *opkg install firmware*.

===========
Применение
===========

Чтобы использовать sysupgrade, вам нужно подключиться к майнеру по SSH. Синтаксис следующий:

::

  sysupgrade [parameters] <image file or URL>

Наиболее важные параметры: **--help** (вывести справку) и **-F** для запуска установки. Рекомендуется использовать этот метод (кроме того, как описано ниже), только если вы действительно знаете, что делаете.

=========================================
Особенности, плюсы и минусы этого метода:
=========================================
  
  + устанавливает различные версии Braiins OS при одновременном подключении к майнеру
  + переносит конфигурацию
  + параметры доступны для настройки процесса
  
  - нет пакетного режима (для массовой установки), если вы не создаете свои собственные скрипты
  - не может переключиться на более старую версию Braiins OS (выпущенную ранее 2020)

.. _sysupgrade_switch_braiinsos:

================================================================================
Переход на Braiins OS (без автонастройки) из других версий с помощью Sysupgrade
================================================================================

Чтобы обновить более старую версию Braiins OS или перейти с более ранней версии Braiins OS+, используйте следующую команду (замените заполнитель ``IP_ADDRESS`` соответственно):

::

  #Antminer S9
  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.org/am1-s9/firmware_2020-09-07-0-e50f2a1b-20.09_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'
  
  #Antminer S17
  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.org/am2-s17/firmware_2020-09-07-0-e50f2a1b-20.09_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'

Эта команда содержит следующие команды: 

  * **ssh** - подключиться к майнеру
  * **wget** - используется для загрузки файлов, в данном случае пакета прошивки
  * **sysupgrade** - фактически прошить скачанный пакет прошивки

.. _sysupgrade_switch_braiinsplus:

============================================================
Переход на Braiins OS+ из других версий с помощью Sysupgrade
============================================================

Чтобы обновить более старую версию Braiins OS, используйте следующую команду (замените заполнитель ``IP_ADDRESS`` соответственно):

::

  #Antminer S9
  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.com/am1-s9/firmware_2020-09-07-1-463cb8d0-20.09-plus_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'
  
  #Antminer S17
  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.com/am2-s17/firmware_2020-11-27-0-5eb922d4-20.11-plus_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'
  
Эта команда содержит следующие команды: 

  * **ssh** - подключиться к майнеру
  * **wget** - используется для загрузки файлов, в данном случае пакета прошивки
  * **sysupgrade** - фактически прошить скачанный пакет прошивки

Примечание: Рекомендуется использовать *BOS Toolbox*, *Braiins OS веб интерфейс* или *opkg install bos_plus* вместо этого метода.

.. _bos2bos:

**************
Bos2Bos скрипт
**************

**Bos2Bos Скрипт не рекомендуется использовать, если только у вас не возникли проблемы с установкой с использованием других методов.** Этот метод работает, только если на устройстве уже запущена Braiins OS.

=========================================
Особенности, плюсы и минусы этого метода:
=========================================
  
  + дистанционная установка любой версии Braiins OS
  + установка чистой версии Braiins OS
  + параметры доступны для настройки процесса
  
  - нет пакетного режима (для массовой установки), если вы не создаете свои собственные скрипты

===========
Применение
===========

Использование скрипта Bos2Bos требует следующей настройки:

* *(Только Windows)* Установить *Ubuntu for Windows 10* доступен в Microsoft Store `здесь. <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6>`_
* Выполните следующие команды в терминале командной строки:

*(Обратите внимание, что команды совместимы с Ubuntu и Ubuntu для Windows 10. Если вы используете другой дистрибутив Linux или другую ОС, пожалуйста, ознакомьтесь с соответствующей документацией и отредактируйте команды при необходимости.)*

::
  
  #Обновите репозитории и установите зависимости
  sudo apt update && sudo apt install python3 python3-virtualenv virtualenv
  
  #Клонируйте хранилище
  git clone https://github.com/braiins/braiins-os.git
  
  #Измените каталог
  cd ./braiins-os/braiins-os/

  #Создайте виртуальную среду и активируйте ее
  virtualenv --python=/usr/bin/python3 .env && source .env/bin/activate
  
  #Установите необходимые пакеты Python
  python3 -m pip install -r requirements.txt

После успешного завершения настройки вы можете использовать следующие команды:

::

  #активировать виртуальную среду
  source .env/bin/activate

  #основное использование заключается в следующем
  python3 bos2bos.py FIRMWARE_URL IP_ADDRESS

  #описание всех доступных параметров может быть отображено с помощью следующей команды
  python3 bos2bos.py -h

**********
Miner tool
**********

.. _miner_nand_install:

=======================================
SD на NAND установка с помощью Miner tool
=======================================

SD-карту можно использовать для замены встроенного программного обеспечения NAND на Braiins OS+. Это можно сделать, подключившись к майнеру по SSH и используя следующую команду:

  ::

    miner nand_install


.. _miner_factory_reset:

===============================================
Braiins OS+ сброс настроек с помощью Miner tool
===============================================

Сброс к заводским настройкам также можно выполнить с помощью *Miner tool*. Используйте следующую команду, чтобы сделать это:

  ::

    miner factory_reset

.. _miner_detect:

==================================================
Обнаружение устройств с светодиодами с Miner tool
==================================================

Вы можете найти устройство, включив мигающий светодиод, используя *Miner tool*. Используйте следующую команду, чтобы сделать это:

  ::

    #turn on LED blinking
    miner fault_light on

    #turn off LED blinking
    miner fault_light off
    
.. _miner_nightly:

==============================================
Turn on/off Nightly feeds using the Miner tool
==============================================

You can turn on Nightly feeds to get updated to the latest nightly builds. These builds aim to fix crucial issues as fast as possible and, because of that, they are not tested as thoroughly as major releases before being published. Use these builds with caution and only if it solves your issues. In order to turn on/off the nightly feeds, use the following command:

  ::

    #turn on nightly feeds
    miner nightly_feeds on

    #turn off nightly feeds
    miner nightly_feeds off

.. _miner_autoupgrade:

==========================================================================
Включить/Выключить автоматическое обновление с использованием Miner tool
==========================================================================

Вы можете включить функцию автоматического обновления, которая автоматически обновит систему до последней версии. Эта функция **включена** по умолчанию после перехода с **стоковой** прошивки и **выключена** по умолчанию после обновления с более старых версий **Braiins OS** или **Braiins OS+**. Чтобы вручную включить/отключить автоматическое обновление, используйте следующую команду:

  ::

    #включить автоматическое обновление
    miner auto_upgrade on

    #отключить автоматическое обновление
    miner auto_upgrade off
